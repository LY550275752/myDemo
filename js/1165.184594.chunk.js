"use strict";(self.webpackChunkclink_web=self.webpackChunkclink_web||[]).push([[1165],{72900:(e,t,n)=>{function o(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function a(e){let t;if("object"!=typeof e)t=e;else if("null"===o(e)||"undefined"===o(e))t=e;else if("array"===o(e)){let n;t=[];const o=e.length;for(n=0;n<o;n++)t.push(e[n])}else if("object"===o(e)){t={};for(let n in e)if(e.hasOwnProperty(n)){const l=e[n];if(l===e)continue;"array"===o(l)||"object"===o(l)?t[n]=a(l):t[n]=l}}else t=e;return t}n.d(t,{Dy:()=>l,Jh:()=>i,Oh:()=>s,d9:()=>a,ds:()=>c,p:()=>r,p6:()=>d});function l(e){let t=0,n="当前密码只包含",o={flag:!1,message:""};return/\s/.test(e)?(o.message="密码不支持空格",o):/[\u4e00-\u9fa5]+/.test(e)?(o.message="密码不支持中文",o):e.length<8||e.length>20?(o.message="密码长度需要在 8-20 位之间",o):(/([a-z])+/.test(e)&&(n+="小写字母 ",t++),/([A-Z])+/.test(e)&&(n+="大写字母 ",t++),/(\d)+/.test(e)&&(n+="数字 ",t++),/[!"#\$%&'\(\)\*\+,-\.\/:;<=>\?@\[\\\]\^_`\{\|\}~]/.test(e)&&(n+="特殊字符 ",t++),t<3?o.message=n:(o.flag=!0,o.message=""),o)}function i(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e.trim())}function r(e){return/1\d{10}/g.test(e.trim())}function c(e){return/^((25[0-5]|2[0-4]\d|[1]{1}\d{1}\d{1}|[1-9]{1}\d{1}|\d{1})($|(?!\.$)\.)){4}$/.test(e)}function s(e){let t=e.split(":"),n=0,o="";if(t.length>2)n=Number(t.pop()),o=t.join(":");else{if(2!==t.length)throw new Error("无法解析服务器地址");o=t[0],n=Number(t[1])}return{host:o,port:n}}function d(e,t="yyyy-MM-dd",n="--"){if(!e)return n;let o=new Date(e);if(e=e+60*o.getTimezoneOffset()*1e3- -288e5,o.setTime(e),"Invalid Date"===o.toString())return n;let a={"M+":o.getMonth()+1,"d+":o.getDate(),"h+":o.getHours(),"m+":o.getMinutes(),"s+":o.getSeconds(),"q+":Math.floor((o.getMonth()+3)/3),S:o.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(o.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in a)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?a[e]:("00"+a[e]).substr((""+a[e]).length)));return t}},51165:(e,t,n)=>{n.r(t),n.d(t,{default:()=>N});var o=n(89810),a=n(72900),l=n(35247),i=n(86756),r=n(73827),c=n(48402),s=n(29997),d=n(6298),u=n(88533),f=function(e,t,n,o){return new(n||(n=Promise))((function(a,l){function i(e){try{c(o.next(e))}catch(e){l(e)}}function r(e){try{c(o.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,r)}c((o=o.apply(e,t||[])).next())}))};const m={class:"device"},v={class:"device-content panel"},g={class:"device-content-form"},p={class:"device-content-form-edit"},h={class:"device-content-btn"},y=(0,o.defineComponent)({__name:"DeviceDetail",props:{data:{type:Object,default:null}},emits:["enter"],setup(e,{emit:t}){const n=e,y=(0,o.inject)("$dialog"),N=c.nC.get(l.bL),C=c.nC.get(d.g);var x=(0,o.ref)(null),V=(0,o.reactive)((0,a.d9)(n.data)),w=(0,o.ref)(!1),b=(0,o.ref)(!1),k=(0,o.ref)(!1);function _(){return f(this,void 0,void 0,(function*(){const e=n.data.isCurr?"确定移除当前浏览器？":"确定移除该设备？",o=n.data.isCurr?"将当前浏览器访问踢下线并退出登录":"将设备踢下线并抹除设备上已记住的密码";i.T.confirm(o,e,{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>f(this,void 0,void 0,(function*(){k.value=!0;try{yield N.deviceUnbind({deviceCode:n.data.deviceCode}),n.data.isCurr?(C.logout({removeAccount:!0}),s.k.info("移除当前设备成功"),y.closeAll()):t("enter","DeviceManage"),r.z8.success("移除设备成功")}catch(e){r.z8.error(e.message)}finally{k.value=!1}})))).catch((()=>{}))}))}function E(){w.value=!0,(0,o.nextTick)((()=>{x.value&&x.value.focus()}))}function M(){w.value=!1,V.deviceName=n.data.deviceName}function D(){return f(this,void 0,void 0,(function*(){if(""===V.deviceName)r.z8.warning("设备名称不能为空！");else if(V.deviceName.length>16)r.z8.warning("设备名称不能超过16个字！");else{const e={deviceCode:V.deviceCode,deviceName:V.deviceName};b.value=!0;try{yield N.deviceEdit(e),r.z8.success("修改设备名称成功"),t("enter","DeviceManage")}catch(e){r.z8.error(e.message)}finally{w.value=!1,b.value=!1}}}))}return(0,o.onMounted)((()=>{var e=y.getCurrentDialogId();(0,o.nextTick)((()=>{y.config(e,{title:"设备详情",onBack:()=>{u.$x.emit("toggle",{type:"DeviceManage"})}})}))})),(e,t)=>{const n=(0,o.resolveComponent)("el-input"),i=(0,o.resolveComponent)("el-button"),r=(0,o.resolveComponent)("el-form-item"),c=(0,o.resolveComponent)("el-divider"),s=(0,o.resolveComponent)("el-form");return(0,o.openBlock)(),(0,o.createElementBlock)("div",m,[(0,o.createElementVNode)("div",v,[(0,o.createElementVNode)("div",g,[(0,o.createVNode)(s,{size:"large",onSubmit:t[1]||(t[1]=(0,o.withModifiers)((()=>{}),["prevent"])),model:(0,o.unref)(V),"label-width":"125px"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(r,{class:"device-content-form-item device-content-form-name",label:"设备名称："},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(n,{maxlength:"16",ref_key:"deviceNameInput",ref:x,modelValue:(0,o.unref)(V).deviceName,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,o.unref)(V).deviceName=e),modelModifiers:{trim:!0},disabled:!(0,o.unref)(w),autofocus:"",class:(0,o.normalizeClass)({"is-focus":(0,o.unref)(w)})},null,8,["modelValue","disabled","class"]),(0,o.createElementVNode)("div",p,[(0,o.unref)(w)?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:1},[(0,o.createVNode)(i,{loading:(0,o.unref)(b),onClick:D,type:"text",size:"small"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("确定")])),_:1},8,["loading"]),(0,o.createVNode)(i,{onClick:M,type:"text",size:"small"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("取消")])),_:1})],64)):((0,o.openBlock)(),(0,o.createBlock)(i,{key:0,onClick:E,type:"text"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("编辑")])),_:1}))])])),_:1}),(0,o.createVNode)(r,{class:"device-content-form-item",label:"设备类型："},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",null,(0,o.toDisplayString)((0,o.unref)(l.Yi)[(0,o.unref)(V).deviceType]),1)])),_:1}),(0,o.createVNode)(r,{class:"device-content-form-item",label:"设备系统："},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",null,(0,o.toDisplayString)((0,o.unref)(V).sysVersion),1)])),_:1}),(0,o.createVNode)(c,{class:"device-content-form-divider"}),(0,o.createVNode)(r,{class:"device-content-form-item",label:"应用版本："},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",null,(0,o.toDisplayString)((0,o.unref)(V).appVersion),1)])),_:1}),(0,o.createVNode)(r,{class:"device-content-form-item",label:"最近登录："},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",null,(0,o.toDisplayString)((0,o.unref)(a.p6)((0,o.unref)(V).lastUseTime,"MM月dd日 hh:mm:ss")),1)])),_:1}),(0,o.createVNode)(r,{class:"device-content-form-item",label:"最近登录产品："},{default:(0,o.withCtx)((()=>{return[(0,o.createElementVNode)("span",null,(0,o.toDisplayString)((e=(0,o.unref)(V).lastAppModel,l.Du[e]||"--")),1)];var e})),_:1})])),_:1},8,["model"])]),(0,o.createElementVNode)("div",h,[(0,o.createVNode)(i,{size:"large",type:"danger",plain:"",loading:(0,o.unref)(k),onClick:_},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("移除设备 ")])),_:1},8,["loading"])])])])}}});const N=(0,n(57775).Z)(y,[["__scopeId","data-v-4c33879a"]])}}]);