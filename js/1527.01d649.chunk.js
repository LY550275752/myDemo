(self.webpackChunkclink_web=self.webpackChunkclink_web||[]).push([[1527],{82917:(e,t,n)=>{var o=NaN,r="[object Symbol]",a=/^\s+|\s+$/g,l=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,c=/^0o[0-7]+$/i,u=parseInt,s="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,f="object"==typeof self&&self&&self.Object===Object&&self,d=s||f||Function("return this")(),p=Object.prototype.toString,m=Math.max,v=Math.min,y=function(){return d.Date.now()};function g(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function h(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&p.call(e)==r}(e))return o;if(g(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=g(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(a,"");var n=i.test(e);return n||c.test(e)?u(e.slice(2),n?2:8):l.test(e)?o:+e}e.exports=function(e,t,n){var o,r,a,l,i,c,u=0,s=!1,f=!1,d=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function p(t){var n=o,a=r;return o=r=void 0,u=t,l=e.apply(a,n)}function k(e){var n=e-c;return void 0===c||n>=t||n<0||f&&e-u>=a}function b(){var e=y();if(k(e))return N(e);i=setTimeout(b,function(e){var n=t-(e-c);return f?v(n,a-(e-u)):n}(e))}function N(e){return i=void 0,d&&o?p(e):(o=r=void 0,l)}function V(){var e=y(),n=k(e);if(o=arguments,r=this,c=e,n){if(void 0===i)return function(e){return u=e,i=setTimeout(b,t),s?p(e):l}(c);if(f)return i=setTimeout(b,t),p(c)}return void 0===i&&(i=setTimeout(b,t)),l}return t=h(t)||0,g(n)&&(s=!!n.leading,a=(f="maxWait"in n)?m(h(n.maxWait)||0,t):a,d="trailing"in n?!!n.trailing:d),V.cancel=function(){void 0!==i&&clearTimeout(i),u=0,o=c=r=i=void 0},V.flush=function(){return void 0===i?l:N(y())},V}},86631:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var o=n(48402),r=n(6298);function a(){return o.nC.get(r.g)}},21313:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>m});var o=n(89810),r=n(88533),a=n(5341);const l={class:"top"},i={class:"left"},c={key:1,class:"right"},u={key:0,class:"content"},s={class:"bottom"},f={class:"left"},d={class:"right"},p=(0,o.defineComponent)({__name:"historyItem",props:{item:{default:()=>({}),required:!0,type:Object}},setup(e){const t=e,n=(0,o.computed)((()=>t.item?t.item.workSheetVO:{})),p=(0,a.mL)(),m=(0,o.inject)("$filter");function v(){r.$x.emit("change-report-page",{to:"detail",data:t.item})}function y(){r.$x.emit("change-report-page",{to:"feedback",data:t.item})}return(e,t)=>{const r=(0,o.resolveComponent)("el-link"),a=(0,o.resolveComponent)("el-badge");return(0,o.openBlock)(),(0,o.createElementBlock)("div",{class:"historyItem",onClick:v},[(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("div",i,(0,o.toDisplayString)((0,o.unref)(n).wsheetTitle),1),(0,o.unref)(p)?((0,o.openBlock)(),(0,o.createElementBlock)("span",{key:0,class:"right",style:(0,o.normalizeStyle)({color:(0,o.unref)(m).formatStatus((0,o.unref)(n).status,"color")})},(0,o.toDisplayString)((0,o.unref)(m).formatStatus((0,o.unref)(n).status,"report")),5)):((0,o.openBlock)(),(0,o.createElementBlock)("div",c,(0,o.toDisplayString)((0,o.unref)(m).formatTime((0,o.unref)(n).createdTime,"YYYY/MM/DD HH:mm")),1))]),(0,o.unref)(p)?((0,o.openBlock)(),(0,o.createElementBlock)("div",u,(0,o.toDisplayString)((0,o.unref)(n).wsheetDesc),1)):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("div",s,[(0,o.createElementVNode)("div",f,(0,o.toDisplayString)((0,o.unref)(p)?(0,o.unref)(m).formatTime((0,o.unref)(n).createdTime,"YYYY/MM/DD HH:mm"):(0,o.unref)(n).wsheetDesc),1),(0,o.createElementVNode)("div",d,[(0,o.unref)(p)?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("span",{key:0,style:(0,o.normalizeStyle)({color:(0,o.unref)(m).formatStatus((0,o.unref)(n).status,"color")})},(0,o.toDisplayString)((0,o.unref)(m).formatStatus((0,o.unref)(n).status,"report")),5)),(0,o.createVNode)(a,{"is-dot":"",class:"ml-4",onClick:(0,o.withModifiers)(y,["stop"]),hidden:0===(0,o.unref)(n).newMsgNum},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(r,{type:"primary",style:{"font-size":"12px","line-height":"16px"},underline:!1},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("报障反馈")])),_:1})])),_:1},8,["onClick","hidden"])])])])}}});const m=(0,n(57775).Z)(p,[["__scopeId","data-v-eb7862bc"]])},81527:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>b});var o=n(89810),r=n(2111),a=n(51882),l=n(86631),i=n(52134),c=n(21313),u=n(82917),s=n.n(u),f=n(88533),d=n(5341),p=function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function l(e){try{c(o.next(e))}catch(e){a(e)}}function i(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,i)}c((o=o.apply(e,t||[])).next())}))};const m={class:"reportHistory"},v={class:"tip-box"},y=(g=()=>(0,o.createElementVNode)("span",{class:"tip-text"},[(0,o.createElementVNode)("div",null,[(0,o.createTextVNode)("您可以拨打我们的客服热线："),(0,o.createElementVNode)("span",{class:"tip-phone"},"400-810-9889")]),(0,o.createElementVNode)("div",null,"或填写故障信息，您所提交的问题我们将尽快解决")],-1),(0,o.pushScopeId)("data-v-fae2435c"),g=g(),(0,o.popScopeId)(),g);var g;const h={class:"search"},k=(0,o.defineComponent)({__name:"historyList",setup(e){const t=(0,a.Z)(),n=(0,l.Z)(),u=((0,o.inject)("$filter"),(0,o.inject)("appInfo")),g=(0,o.ref)(620),k=(0,o.ref)({text:"",page:1,limit:10,loading:!1,msg:"",total:0,retry:!1}),b=(0,o.ref)([]),N=(0,o.ref)(null),V=(0,o.computed)((()=>k.value.msg?k.value.msg:k.value.loading?"正在加载中...":k.value.total<=k.value.page*k.value.limit?"没有更多数据":"点击加载更多")),x=s()((()=>{k.value.page=1,b.value=[],w()}),300);function w(){return p(this,void 0,void 0,(function*(){k.value.loading=!0,k.value.retry=!1,k.value.msg="";const{page:e,limit:r}=k.value,a=yield n.getAuthProfile();let l={appInfo:(0,o.toRaw)(u.value),workSheetReqVO:{wsheetTitle:k.value.text,pageNum:e,pageSize:r,userAcount:null==a?void 0:a.userAccount}};const c=Date.now();l.appInfo.timeStamp=c,l.appInfo.sign=(0,i.gw)(c,i.eW,u.value.tenantId);try{const e=yield t.getHistoryReport(l);k.value.total=e.data.total,e.data.list&&(b.value=b.value.concat(e.data.list)),k.value.loading=!1}catch(e){k.value.retry=!0,k.value.msg=e.message,k.value.loading=!1}}))}const C=s()((e=>{if(N.value){document.getElementsByClassName("historyScroll")[0];e.scrollTop+N.value.clientHeight>g.value&&!k.value.loading&&k.value.total>k.value.page*k.value.limit&&(k.value.page+=1,w())}}),200);function E(){f.$x.emit(f.eM.GO_REPORT,"report")}return(0,o.onMounted)((()=>{w(),(0,d.mL)()?g.value="98%":g.value=document.body.clientWidth>900&&document.body.clientHeight>700?620:"69vh"})),(e,t)=>{const n=(0,o.resolveComponent)("el-button"),a=(0,o.resolveComponent)("el-input"),l=(0,o.resolveComponent)("el-scrollbar");return(0,o.openBlock)(),(0,o.createBlock)(l,{onScroll:(0,o.unref)(C),height:g.value,"view-class":"historyScroll"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",m,[(0,o.createElementVNode)("div",v,[y,(0,o.createVNode)(n,{type:"primary",class:"reporting-btn",onClick:E},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("我要报障")])),_:1})]),(0,o.createElementVNode)("div",h,[(0,o.createVNode)(a,{modelValue:k.value.text,"onUpdate:modelValue":t[0]||(t[0]=e=>k.value.text=e),placeholder:"请输入标题内容进行搜索",clearable:"","suffix-icon":(0,o.unref)(r.Z),onInput:(0,o.unref)(x)},null,8,["modelValue","suffix-icon","onInput"])]),(0,o.createElementVNode)("div",{class:"historyList",ref_key:"listRef",ref:N},[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(b.value,((e,t)=>((0,o.openBlock)(),(0,o.createBlock)(c.default,{item:e,key:t},null,8,["item"])))),128))],512),(0,o.createElementVNode)("div",{class:"loadMore",onClick:t[1]||(t[1]=(...e)=>(0,o.unref)(C)&&(0,o.unref)(C)(...e))},[(0,o.createElementVNode)("div",null,(0,o.toDisplayString)((0,o.unref)(V)),1),k.value.retry?((0,o.openBlock)(),(0,o.createBlock)(n,{key:0,class:"mt-2",onClick:w,type:"primary"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("重试")])),_:1})):(0,o.createCommentVNode)("",!0)])])])),_:1},8,["onScroll","height"])}}});const b=(0,n(57775).Z)(k,[["__scopeId","data-v-fae2435c"]])}}]);