"use strict";(self.webpackChunkclink_web=self.webpackChunkclink_web||[]).push([[2107,9675,3625,1025,9843],{39675:(e,n,t)=>{t.r(n),t.d(n,{default:()=>g});var a=t(89810),l=t(1725),o=t(48402);const c={class:"item-header"},s=(r=()=>(0,a.createElementVNode)("div",{class:"item-header-left"},[(0,a.createElementVNode)("span",{class:"item-header-left-icon"},[(0,a.createElementVNode)("i",{class:"iconfont icon-announcement-empty"})]),(0,a.createElementVNode)("span",{class:"item-header-left-name"},"公告")],-1),(0,a.pushScopeId)("data-v-01a977fa"),r=r(),(0,a.popScopeId)(),r);var r;const i={class:"item-header-right"},d={class:"item-header-right-time"},m={class:"item-content"},u={class:"item-content-title single-line"},p={key:0,class:"item-content-title-unread"},v={class:"item-content-sub single-line"},f=(0,a.defineComponent)({__name:"announcementItem",props:{announcement:{type:Object,require:!0,default:()=>{}}},setup(e){const n=e,t=o.nC.get(l.pX);function r(){t.openMessageDetail({data:n.announcement,source:l.Vh.MESSAGE_CENTER})}return(n,l)=>{return(0,a.openBlock)(),(0,a.createElementBlock)("div",{class:"item",onClick:r},[(0,a.createElementVNode)("div",c,[s,(0,a.createElementVNode)("div",i,[(0,a.createElementVNode)("div",d,(0,a.toDisplayString)((o=e.announcement.validTime,t.formatTime(o))),1)])]),(0,a.createElementVNode)("div",m,[(0,a.createElementVNode)("div",u,[(0,a.createTextVNode)((0,a.toDisplayString)(e.announcement.title)+" ",1),0===e.announcement.haveRead?((0,a.openBlock)(),(0,a.createElementBlock)("span",p)):(0,a.createCommentVNode)("",!0)]),(0,a.createElementVNode)("div",v,(0,a.toDisplayString)(e.announcement.content),1)])]);var o}}});const g=(0,t(57775).Z)(f,[["__scopeId","data-v-01a977fa"]])},23625:(e,n,t)=>{t.r(n),t.d(n,{default:()=>h});var a=t(89810),l=t(2525),o=t(1725),c=t(48402),s=t(39675);const r=e=>((0,a.pushScopeId)("data-v-03ed55f4"),e=e(),(0,a.popScopeId)(),e),i={class:"announcement"},d={class:"announcement-header-select"},m={key:0,class:"announcement-content"},u={key:1,class:"announcement-empty"},p=r((()=>(0,a.createElementVNode)("img",{src:l,draggable:"false"},null,-1))),v={key:2,class:"announcement-top"},f=[r((()=>(0,a.createElementVNode)("i",{class:"el-icon-top"},null,-1)))],g=(0,a.defineComponent)({__name:"announcementList",props:{announcementList:{type:Array,default:()=>[]}},setup(e){const n=e;(0,a.watch)((()=>n.announcementList),(()=>{l.value=n.announcementList}),{deep:!0});const t=c.nC.get(o.pX);var l=(0,a.ref)([]),r=(0,a.ref)(0),g=[{label:"全部",value:0},{label:"已读",value:1},{label:"未读",value:2}];function h(){switch(r.value){case 0:l.value=n.announcementList;break;case 1:l.value=n.announcementList.filter((e=>1===e.haveRead));break;case 2:l.value=n.announcementList.filter((e=>0===e.haveRead))}}function k(){t.handleReadAllAnnouncement()}return(e,n)=>{const t=(0,a.resolveComponent)("el-option"),o=(0,a.resolveComponent)("el-select");return(0,a.openBlock)(),(0,a.createElementBlock)("div",i,[(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["announcement-header",{"announcement-header-extra-padding":(0,a.unref)(l).length>6}])},[(0,a.createElementVNode)("div",d,[(0,a.createVNode)(o,{modelValue:(0,a.unref)(r),"onUpdate:modelValue":n[0]||(n[0]=e=>(0,a.isRef)(r)?r.value=e:r=e),onChange:h,clearable:!1,placeholder:"请选择",size:"small"},{default:(0,a.withCtx)((()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)((0,a.unref)(g),(e=>((0,a.openBlock)(),(0,a.createBlock)(t,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,a.createElementVNode)("div",{class:"annocement-header-box"},[(0,a.createElementVNode)("span",{class:"announcement-header-box-btn",onClick:k},"全部已读")])],2),(0,a.unref)(l).length>0?((0,a.openBlock)(),(0,a.createElementBlock)("div",m,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)((0,a.unref)(l),(e=>((0,a.openBlock)(),(0,a.createBlock)(s.default,{key:e.msgId,announcement:e},null,8,["announcement"])))),128))])):((0,a.openBlock)(),(0,a.createElementBlock)("div",u,[p,(0,a.createTextVNode)(" 暂无公告 ")])),(0,a.unref)(l).length>6?((0,a.openBlock)(),(0,a.createElementBlock)("div",v,f)):(0,a.createCommentVNode)("",!0)])}}});const h=(0,t(57775).Z)(g,[["__scopeId","data-v-03ed55f4"]])},40475:(e,n,t)=>{t.r(n),t.d(n,{default:()=>h});var a=t(89810),l=t(69581),o=t(23625),c=t(1725),s=t(48402),r=t(92720),i=function(e,n,t,a){return new(t||(t=Promise))((function(l,o){function c(e){try{r(a.next(e))}catch(e){o(e)}}function s(e){try{r(a.throw(e))}catch(e){o(e)}}function r(e){var n;e.done?l(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(c,s)}r((a=a.apply(e,n||[])).next())}))};const d={class:"message-center"},m={class:"message-center__header"},u={class:"message-center__header-tab-label"},p={class:"message-center__header-tab-label"},v={class:"message-center__header-setting"},f={class:"message-center__content"},g=(0,a.defineComponent)({__name:"messageCenter",setup(e){const n=s.nC.get(c.pX),t=(0,a.inject)("$dialog");var g=(0,a.ref)("message"),h=(0,a.ref)([]),k=(0,a.ref)([]),E=!1,V=(0,a.ref)([]);const N=(0,a.computed)((()=>{var e=!1;return k.value.forEach((n=>{0===n.haveRead&&(e=!0)})),e}));function _(e){V.value.includes(e)?V.value=V.value.filter((n=>n!==e)):V.value.push(e)}function C(){return i(this,void 0,void 0,(function*(){t.open("messageSetting")}))}return(0,a.onMounted)((()=>i(this,void 0,void 0,(function*(){(0,a.nextTick)((()=>{const e=window.innerHeight>1e3?640:560;var n=t.getCurrentDialogId();t.config(n,{title:"天翼云电脑消息中心",width:480,height:e})})),h.value=yield n.initMessageListOfApp(),1===h.value.length&&h.value[0].messageList.length>1&&(V.value=[h.value[0].app.appId]),k.value=n.initAnnouncementList(),n.onReloadDataInFrame.on((()=>{!function(){i(this,void 0,void 0,(function*(){if(!E){E=!0;var e=yield n.initMessageListOfApp(),t=n.initAnnouncementList();k.value=(0,r.cloneDeep)(t),h.value=(0,r.cloneDeep)(e),h.value.forEach((e=>{e.messageLists&&1===e.messageLists.length&&(V.value=V.value.filter((n=>n!==e.app.appId)))}))}E=!1}))}()}))})))),(e,n)=>{const t=(0,a.resolveComponent)("el-badge"),c=(0,a.resolveComponent)("el-tab-pane"),s=(0,a.resolveComponent)("el-tabs"),r=(0,a.resolveComponent)("el-tooltip");return(0,a.openBlock)(),(0,a.createElementBlock)("div",d,[(0,a.createElementVNode)("div",m,[(0,a.createVNode)(s,{modelValue:(0,a.unref)(g),"onUpdate:modelValue":n[0]||(n[0]=e=>(0,a.isRef)(g)?g.value=e:g=e),class:"message-center__header-tab"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(c,{name:"message"},{label:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",u,[(0,a.createVNode)(t,{"is-dot":(0,a.unref)(h).length>0,class:"item"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)("消息")])),_:1},8,["is-dot"])])])),_:1}),(0,a.createVNode)(c,{name:"announcement"},{label:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",p,[(0,a.unref)(N)?((0,a.openBlock)(),(0,a.createBlock)(t,{key:0,"is-dot":"",class:"item"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)("公告")])),_:1})):((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:1},[(0,a.createTextVNode)("公告")],64))])])),_:1})])),_:1},8,["modelValue"]),(0,a.createElementVNode)("div",v,[(0,a.createVNode)(r,{effect:"dark",content:"设置","visible-arrow":!1,placement:"bottom"},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("span",{class:"message-center__header-setting-icon"},[(0,a.createElementVNode)("i",{class:"iconfont icon-shezhi",onClick:C})])])),_:1})])]),(0,a.createElementVNode)("div",f,[(0,a.withDirectives)((0,a.createVNode)(l.default,{"message-list":(0,a.unref)(h),"expand-app-message":(0,a.unref)(V),onOnExpandChange:_},null,8,["message-list","expand-app-message"]),[[a.vShow,"message"===(0,a.unref)(g)]]),(0,a.withDirectives)((0,a.createVNode)(o.default,{"announcement-list":(0,a.unref)(k)},null,8,["announcement-list"]),[[a.vShow,"announcement"===(0,a.unref)(g)]])])])}}});const h=(0,t(57775).Z)(g,[["__scopeId","data-v-44f2884c"]])},69581:(e,n,t)=>{t.r(n),t.d(n,{default:()=>f});var a=t(89810),l=t(2525),o=t(1725),c=t(48402),s=t(46310),r=function(e,n,t,a){return new(t||(t=Promise))((function(l,o){function c(e){try{r(a.next(e))}catch(e){o(e)}}function s(e){try{r(a.throw(e))}catch(e){o(e)}}function r(e){var n;e.done?l(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(c,s)}r((a=a.apply(e,n||[])).next())}))};const i={class:"message"},d={key:0,class:"message-content"},m={key:1,class:"message-empty"},u=(p=()=>(0,a.createElementVNode)("img",{src:l,draggable:"false"},null,-1),(0,a.pushScopeId)("data-v-7d3ae062"),p=p(),(0,a.popScopeId)(),p);var p;const v=(0,a.defineComponent)({__name:"messageList",props:{messageList:{type:Array,default:()=>[]},expandAppMessage:{type:Array,default:()=>[]}},emits:["onExpandChange"],setup(e,{emit:n}){const t=e,l=c.nC.get(o.pX);function p(){return r(this,void 0,void 0,(function*(){0!==t.messageList.length&&l.handleDeleteAllAppMessage()}))}function v(e){n("onExpandChange",e)}return(n,t)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",i,[(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["message-header",{"message-header-extra-padding":e.messageList.length>6}])},[(0,a.createElementVNode)("span",{class:"message-header-clear",onClick:p},"全部清除")],2),e.messageList.length>0?((0,a.openBlock)(),(0,a.createElementBlock)("div",d,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.messageList,(n=>((0,a.openBlock)(),(0,a.createBlock)(s.default,{class:"message-content-item",key:n.app.appId,param:n,"is-expand":e.expandAppMessage.includes(n.app.appId),onOnExpandChange:v},null,8,["param","is-expand"])))),128))])):((0,a.openBlock)(),(0,a.createElementBlock)("div",m,[u,(0,a.createTextVNode)(" 暂无消息 ")]))]))}});const f=(0,t(57775).Z)(v,[["__scopeId","data-v-7d3ae062"]])},2525:(e,n,t)=>{e.exports=t.p+"imgs/message.3dd596.svg"}}]);