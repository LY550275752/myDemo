"use strict";(self.webpackChunkclink_web=self.webpackChunkclink_web||[]).push([[3624],{72900:(e,t,n)=>{function i(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function o(e){let t;if("object"!=typeof e)t=e;else if("null"===i(e)||"undefined"===i(e))t=e;else if("array"===i(e)){let n;t=[];const i=e.length;for(n=0;n<i;n++)t.push(e[n])}else if("object"===i(e)){t={};for(let n in e)if(e.hasOwnProperty(n)){const r=e[n];if(r===e)continue;"array"===i(r)||"object"===i(r)?t[n]=o(r):t[n]=r}}else t=e;return t}n.d(t,{Dy:()=>r,Jh:()=>c,Oh:()=>s,d9:()=>o,ds:()=>l,p:()=>a,p6:()=>d});function r(e){let t=0,n="当前密码只包含",i={flag:!1,message:""};return/\s/.test(e)?(i.message="密码不支持空格",i):/[\u4e00-\u9fa5]+/.test(e)?(i.message="密码不支持中文",i):e.length<8||e.length>20?(i.message="密码长度需要在 8-20 位之间",i):(/([a-z])+/.test(e)&&(n+="小写字母 ",t++),/([A-Z])+/.test(e)&&(n+="大写字母 ",t++),/(\d)+/.test(e)&&(n+="数字 ",t++),/[!"#\$%&'\(\)\*\+,-\.\/:;<=>\?@\[\\\]\^_`\{\|\}~]/.test(e)&&(n+="特殊字符 ",t++),t<3?i.message=n:(i.flag=!0,i.message=""),i)}function c(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e.trim())}function a(e){return/1\d{10}/g.test(e.trim())}function l(e){return/^((25[0-5]|2[0-4]\d|[1]{1}\d{1}\d{1}|[1-9]{1}\d{1}|\d{1})($|(?!\.$)\.)){4}$/.test(e)}function s(e){let t=e.split(":"),n=0,i="";if(t.length>2)n=Number(t.pop()),i=t.join(":");else{if(2!==t.length)throw new Error("无法解析服务器地址");i=t[0],n=Number(t[1])}return{host:i,port:n}}function d(e,t="yyyy-MM-dd",n="--"){if(!e)return n;let i=new Date(e);if(e=e+60*i.getTimezoneOffset()*1e3- -288e5,i.setTime(e),"Invalid Date"===i.toString())return n;let o={"M+":i.getMonth()+1,"d+":i.getDate(),"h+":i.getHours(),"m+":i.getMinutes(),"s+":i.getSeconds(),"q+":Math.floor((i.getMonth()+3)/3),S:i.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(i.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in o)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?o[e]:("00"+o[e]).substr((""+o[e]).length)));return t}},35247:(e,t,n)=>{n.d(t,{Yi:()=>d,bC:()=>u,wz:()=>s,we:()=>l,Du:()=>a,bL:()=>y});var i=n(48402),o=n(6298),r=n(6522),c=n(88538);const a={1:"云电脑",2:"云电脑",3:"云手机"};var l;!function(e){e[e.UNDO=0]="UNDO",e[e.IGNORE=1]="IGNORE"}(l||(l={}));const s={1:"非工作时间异常",2:"登录地点异常","1#2":"非工作时间异常和登录地点异常"},d={10:"瘦终端",11:"瘦终端",15:"IPTV",20:"Android Phone",25:"PC",26:"WinXP-PC",30:"iPhone",35:"Android Pad",40:"iPad",45:"Mac",60:"Web客户端",90:"Web"},u={10:{color:"#32CC93",name:"equipment-1"},11:{color:"#32CC93",name:"equipment-1"},15:{color:"#4CA7FB",name:"equipment-3"},20:{color:"#4CA7FB",name:"equipment-3"},25:{color:"#FD893A",name:"equipment-4"},26:{color:"#FD893A",name:"equipment-4"},30:{color:"#4CA7FB",name:"equipment-2"},35:{color:"#4CA7FB",name:"equipment-3"},40:{color:"#4CA7FB",name:"equipment-2"},45:{color:"#FD893A",name:"equipment-5"},def:{color:"#FD893A",name:"equipment-6"}};var f,p,m,v=function(e,t,n,i){var o,r=arguments.length,c=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(c=(r<3?o(c):r>3?o(t,n,c):o(t,n))||c);return r>3&&c&&Object.defineProperty(t,n,c),c},g=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},h=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function c(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,a)}l((i=i.apply(e,t||[])).next())}))};let y=class{constructor(e,t,n){this.auth=e,this.request=t,this.env=n}getLogs(e){return h(this,void 0,void 0,(function*(){e.oneDay||1!==e.pageNum||(e.lastRecordLoginTime=0,e.lastRecordUserLogId=0);return(yield this.getApi("api/cdserv/client/getLogs",e)).data}))}getExcepLogCounts(e){return h(this,void 0,void 0,(function*(){const t=yield this.auth.getAuthProfile();if(!e||!t)return;const n={desktopId:e,userId:t.userId};return(yield this.getApi("api/cdserv/client/getExcepLogCounts",n)).data}))}ignoreAllExcepLogs(){return h(this,void 0,void 0,(function*(){return yield this.postApi("api/cdserv/client/ignoreAllExcepLogs")}))}handleExcepLog(e){return h(this,void 0,void 0,(function*(){return yield this.postApi("api/cdserv/client/handleExcepLog",e)}))}getDeviceList(){return h(this,void 0,void 0,(function*(){return(yield this.getApi("api/cdserv/client/device/list")).data}))}deviceUnbind(e){return h(this,void 0,void 0,(function*(){return yield this.postApi("api/cdserv/client/device/unbinding",e)}))}deviceEdit(e){return h(this,void 0,void 0,(function*(){return yield this.postApi("api/cdserv/client/device/edit",e)}))}getApi(e,t){return this.request.api({url:e,method:"GET",params:t})}postApi(e,t){return h(this,void 0,void 0,(function*(){return this.request.api({url:e,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:t})}))}};y=v([(0,i.Xn)(),g("design:paramtypes",["function"==typeof(f=void 0!==o.g&&o.g)?f:Object,"function"==typeof(p=void 0!==c.cf&&c.cf)?p:Object,"function"==typeof(m=void 0!==r.Xb&&r.Xb)?m:Object])],y)},83624:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b});var i=n(89810),o=n(72900),r=n(35247),c=n(86756),a=n(73827),l=n(48402),s=n(29997),d=n(6298),u=n(17999),f=n(5341),p=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function c(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,a)}l((i=i.apply(e,t||[])).next())}))};const m={class:"device"},v={class:"device-content panel"},g={class:"device-content-form"},h={class:"device-content-form-edit"},y={class:"device-content-btn"},C=(0,i.defineComponent)({__name:"deviceDetail",props:{params:{type:Object,default:null}},emits:["enter"],setup(e,{emit:t}){const n=e,C=(0,i.inject)("$dialog"),b=l.nC.get(r.bL),N=l.nC.get(d.g),w=(0,u.tv)();var x=(0,i.ref)(null),V=(0,i.reactive)((0,o.d9)(n.params)),A=(0,i.ref)(!1),E=(0,i.ref)(!1),D=(0,i.ref)(!1);const k=(0,i.ref)((0,f.mL)()?110:125);function _(){return p(this,void 0,void 0,(function*(){const e=n.params.isCurr?"确定移除当前浏览器？":"确定移除该设备？",i=n.params.isCurr?"将当前浏览器访问踢下线并退出登录":"将设备踢下线并抹除设备上已记住的密码";c.T.confirm(i,e,{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>p(this,void 0,void 0,(function*(){D.value=!0;try{yield b.deviceUnbind({deviceCode:n.params.deviceCode}),n.params.isCurr?(N.logout({removeAccount:!0}),s.k.info("移除当前设备成功"),C.closeAll(),w.push({name:"login"})):t("enter","DeviceManage"),a.z8.success("移除设备成功")}catch(e){a.z8.error(e.message)}finally{D.value=!1}})))).catch((()=>{}))}))}function M(){A.value=!0,(0,i.nextTick)((()=>{x.value&&x.value.focus()}))}function T(){A.value=!1,V.deviceName=n.params.deviceName}function z(){return p(this,void 0,void 0,(function*(){if(""===V.deviceName)a.z8.warning("设备名称不能为空！");else if(V.deviceName.length>16)a.z8.warning("设备名称不能超过16个字！");else{const e={deviceCode:V.deviceCode,deviceName:V.deviceName};E.value=!0;try{yield b.deviceEdit(e),a.z8.success("修改设备名称成功"),t("enter","DeviceManage")}catch(e){a.z8.error(e.message)}finally{A.value=!1,E.value=!1}}}))}return(0,i.onMounted)((()=>{var e=C.getCurrentDialogId();(0,i.nextTick)((()=>{C.config(e,{title:"设备详情",onBack:()=>{t("enter","DeviceManage")}})}))})),(e,t)=>{const n=(0,i.resolveComponent)("el-input"),c=(0,i.resolveComponent)("el-button"),a=(0,i.resolveComponent)("el-form-item"),l=(0,i.resolveComponent)("el-divider"),s=(0,i.resolveComponent)("el-form");return(0,i.openBlock)(),(0,i.createElementBlock)("div",m,[(0,i.createElementVNode)("div",v,[(0,i.createElementVNode)("div",g,[(0,i.createVNode)(s,{size:"large",onSubmit:t[1]||(t[1]=(0,i.withModifiers)((()=>{}),["prevent"])),model:(0,i.unref)(V),"label-width":k.value},{default:(0,i.withCtx)((()=>[(0,i.createVNode)(a,{class:"device-content-form-item device-content-form-name",label:"设备名称："},{default:(0,i.withCtx)((()=>[(0,i.createVNode)(n,{ref_key:"deviceNameInput",ref:x,maxlength:"16",modelValue:(0,i.unref)(V).deviceName,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,i.unref)(V).deviceName=e),modelModifiers:{trim:!0},disabled:!(0,i.unref)(A),autofocus:"",class:(0,i.normalizeClass)({"is-focus":(0,i.unref)(A)})},null,8,["modelValue","disabled","class"]),(0,i.createElementVNode)("div",h,[(0,i.unref)(A)?((0,i.openBlock)(),(0,i.createElementBlock)(i.Fragment,{key:1},[(0,i.createVNode)(c,{loading:(0,i.unref)(E),onClick:z,type:"text",size:"small"},{default:(0,i.withCtx)((()=>[(0,i.createTextVNode)("确定")])),_:1},8,["loading"]),(0,i.createVNode)(c,{onClick:T,type:"text",size:"small"},{default:(0,i.withCtx)((()=>[(0,i.createTextVNode)("取消")])),_:1})],64)):((0,i.openBlock)(),(0,i.createBlock)(c,{key:0,onClick:M,type:"text"},{default:(0,i.withCtx)((()=>[(0,i.createTextVNode)("编辑")])),_:1}))])])),_:1}),(0,i.createVNode)(a,{class:"device-content-form-item",label:"设备类型："},{default:(0,i.withCtx)((()=>[(0,i.createElementVNode)("span",null,(0,i.toDisplayString)((0,i.unref)(r.Yi)[(0,i.unref)(V).deviceType]),1)])),_:1}),(0,i.createVNode)(a,{class:"device-content-form-item item-border-bottom-none",label:"设备系统："},{default:(0,i.withCtx)((()=>[(0,i.createElementVNode)("span",null,(0,i.toDisplayString)((0,i.unref)(V).sysVersion),1)])),_:1}),(0,i.createVNode)(l,{class:"device-content-form-divider"}),(0,i.createVNode)(a,{class:"device-content-form-item form-item-divider",label:"应用版本："},{default:(0,i.withCtx)((()=>[(0,i.createElementVNode)("span",null,(0,i.toDisplayString)((0,i.unref)(V).appVersion),1)])),_:1}),(0,i.createVNode)(a,{class:"device-content-form-item",label:"最近登录："},{default:(0,i.withCtx)((()=>[(0,i.createElementVNode)("span",null,(0,i.toDisplayString)((0,i.unref)(o.p6)((0,i.unref)(V).lastUseTime,"MM月dd日 hh:mm:ss")),1)])),_:1}),(0,i.createVNode)(a,{class:"device-content-form-item item-border-bottom-none",label:"最近登录产品："},{default:(0,i.withCtx)((()=>{return[(0,i.createElementVNode)("span",null,(0,i.toDisplayString)((e=(0,i.unref)(V).lastAppModel,r.Du[e]||"--")),1)];var e})),_:1})])),_:1},8,["model","label-width"])]),(0,i.createElementVNode)("div",y,[(0,i.createVNode)(c,{size:"large",type:"danger",plain:"",loading:(0,i.unref)(D),onClick:_},{default:(0,i.withCtx)((()=>[(0,i.createTextVNode)("移除设备 ")])),_:1},8,["loading"])])])])}}});const b=(0,n(57775).Z)(C,[["__scopeId","data-v-59f89d09"]])}}]);