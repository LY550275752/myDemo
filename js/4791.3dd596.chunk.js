(self.webpackChunkclink_web=self.webpackChunkclink_web||[]).push([[4791],{14957:(e,t,n)=>{"use strict";n.d(t,{V:()=>x});var i=n(28125),o=n(65553),a=n(52429),r=n(89810),s=n(50729),c=n(75566),l=n(24577),d=n(66156),u=n(48331),f=n(47383),h=n(16934),p=n(69077),v=(0,s.do)("action-sheet"),m=(0,a.Z)(v,2),g=m[0],y=m[1],b=(0,c.l7)({},p.W,{title:String,round:l.J5,actions:(0,l.Ce)(),closeIcon:(0,l.SQ)("cross"),closeable:l.J5,cancelText:String,description:String,closeOnPopstate:l.J5,closeOnClickAction:Boolean,safeAreaInsetBottom:l.J5}),k=[].concat((0,o.Z)(p.m),["round","closeOnPopstate","safeAreaInsetBottom"]),w=(0,r.defineComponent)({name:g,props:b,emits:["select","cancel","update:show"],setup:function(e,t){var n=t.slots,i=t.emit,o=function(e){return i("update:show",e)},a=function(){o(!1),i("cancel")},s=function(){if(e.title)return(0,r.createVNode)("div",{class:y("header")},[e.title,e.closeable&&(0,r.createVNode)(u.J,{name:e.closeIcon,class:[y("close"),d.e9],onClick:a},null)])},l=function(){if(n.cancel||e.cancelText)return[(0,r.createVNode)("div",{class:y("gap")},null),(0,r.createVNode)("button",{type:"button",class:y("cancel"),onClick:a},[n.cancel?n.cancel():e.cancelText])]},p=function(e,t){return e.loading?(0,r.createVNode)(h.g,{class:y("loading-icon")},null):n.action?n.action({action:e,index:t}):[(0,r.createVNode)("span",{class:y("name")},[e.name]),e.subname&&(0,r.createVNode)("div",{class:y("subname")},[e.subname])]},v=function(t,n){var a=t.color,s=t.loading,c=t.callback,l=t.disabled,d=t.className;return(0,r.createVNode)("button",{type:"button",style:{color:a},class:[y("item",{loading:s,disabled:l}),d],onClick:function(){l||s||(c&&c(t),e.closeOnClickAction&&o(!1),(0,r.nextTick)((function(){return i("select",t,n)})))}},[p(t,n)])},m=function(){if(e.description||n.description){var t=n.description?n.description():e.description;return(0,r.createVNode)("div",{class:y("description")},[t])}};return function(){return(0,r.createVNode)(f.G,(0,r.mergeProps)({class:y(),position:"bottom","onUpdate:show":o},(0,c.ei)(e,k)),{default:function(){var t;return[s(),m(),(0,r.createVNode)("div",{class:y("content")},[e.actions.map(v),null==(t=n.default)?void 0:t.call(n)]),l()]}})}}}),x=(0,i.n)(w)},44487:(e,t,n)=>{"use strict";n.d(t,{a:()=>k});var i=n(28125),o=n(52429),a=n(89810),r=n(50729),s=n(24577),c=n(64338),l=n(33745),d=n(66898),u=Symbol(),f=n(16934),h=(0,r.do)("list"),p=(0,o.Z)(h,3),v=p[0],m=p[1],g=p[2],y={error:Boolean,offset:(0,s.SI)(300),loading:Boolean,finished:Boolean,errorText:String,direction:(0,s.SQ)("down"),loadingText:String,finishedText:String,immediateCheck:s.J5},b=(0,a.defineComponent)({name:v,props:y,emits:["load","update:error","update:loading"],setup:function(e,t){var n=t.emit,i=t.slots,o=(0,a.ref)(e.loading),r=(0,a.ref)(),s=(0,a.ref)(),h=(0,a.inject)(u,null),p=(0,l.eo)(r),v=function(){(0,a.nextTick)((function(){if(!(o.value||e.finished||e.error||!1===(null==h?void 0:h.value))){var t=e.offset,i=e.direction,a=(0,l.EL)(p);if(a.height&&!(0,c.xj)(r)){var d=(0,l.EL)(s);("up"===i?a.top-d.top<=t:d.bottom-a.bottom<=t)&&(o.value=!0,n("update:loading",!0),n("load"))}}}))},y=function(){if(e.finished){var t=i.finished?i.finished():e.finishedText;if(t)return(0,a.createVNode)("div",{class:m("finished-text")},[t])}},b=function(){n("update:error",!1),v()},k=function(){if(e.error){var t=i.error?i.error():e.errorText;if(t)return(0,a.createVNode)("div",{role:"button",class:m("error-text"),tabindex:0,onClick:b},[t])}},w=function(){if(o.value&&!e.finished)return(0,a.createVNode)("div",{class:m("loading")},[i.loading?i.loading():(0,a.createVNode)(f.g,{class:m("loading-icon")},{default:function(){return[e.loadingText||g("loading")]}})])};return(0,a.watch)((function(){return[e.loading,e.finished,e.error]}),v),h&&(0,a.watch)(h,(function(e){e&&v()})),(0,a.onUpdated)((function(){o.value=e.loading})),(0,a.onMounted)((function(){e.immediateCheck&&v()})),(0,d.F)({check:v}),(0,l.OR)("scroll",v,{target:p,passive:!0}),function(){var t,n=null==(t=i.default)?void 0:t.call(i),c=(0,a.createVNode)("div",{ref:s,class:m("placeholder")},null);return(0,a.createVNode)("div",{ref:r,role:"feed",class:m(),"aria-busy":o.value},["down"===e.direction?n:c,w(),y(),k(),"up"===e.direction?n:c])}}}),k=(0,i.n)(b)},58326:(e,t,n)=>{"use strict";n.d(t,{I:()=>k});var i=n(28125),o=n(52429),a=n(89810),r=n(50729),s=n(24577),c=n(64338),l=n(33745),d=n(31166),u=n(16934),f=(0,r.do)("pull-refresh"),h=(0,o.Z)(f,3),p=h[0],v=h[1],m=h[2],g=["pulling","loosing","success"],y={disabled:Boolean,modelValue:Boolean,headHeight:(0,s.SI)(50),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:s.Or,successDuration:(0,s.SI)(500),animationDuration:(0,s.SI)(300)},b=(0,a.defineComponent)({name:p,props:y,emits:["change","refresh","update:modelValue"],setup:function(e,t){var n,i=t.emit,o=t.slots,r=(0,a.ref)(),s=(0,a.ref)(),f=(0,l.eo)(r),h=(0,a.reactive)({status:"normal",distance:0,duration:0}),p=(0,d.o)(),y=function(){if(50!==e.headHeight)return{height:"".concat(e.headHeight,"px")}},b=function(){return"loading"!==h.status&&"success"!==h.status&&!e.disabled},k=function(t,n){var o=+(e.pullDistance||e.headHeight);h.distance=t,h.status=n?"loading":0===t?"normal":t<o?"pulling":"loosing",i("change",{status:h.status,distance:t})},w=function(){var t=h.status;return"normal"===t?"":e["".concat(t,"Text")]||m(t)},x=function(){var e=h.status,t=h.distance;if(o[e])return o[e]({distance:t});var n=[];return g.includes(e)&&n.push((0,a.createVNode)("div",{class:v("text")},[w()])),"loading"===e&&n.push((0,a.createVNode)(u.g,{class:v("loading")},{default:w})),n},V=function(e){(n=0===(0,c.cx)(f.value))&&(h.duration=0,p.start(e))},C=function(e){b()&&V(e)},R=function(){n&&p.deltaY.value&&b()&&(h.duration=+e.animationDuration,"loosing"===h.status?(k(+e.headHeight,!0),i("update:modelValue",!0),(0,a.nextTick)((function(){return i("refresh")}))):k(0))};return(0,a.watch)((function(){return e.modelValue}),(function(t){h.duration=+e.animationDuration,t?k(+e.headHeight,!0):o.success||e.successText?(h.status="success",setTimeout((function(){k(0)}),+e.successDuration)):k(0,!1)})),(0,l.OR)("touchmove",(function(t){if(b()){n||V(t);var i=p.deltaY;p.move(t),n&&i.value>=0&&p.isVertical()&&((0,c.PF)(t),k((o=i.value,a=+(e.pullDistance||e.headHeight),o>a&&(o=o<2*a?a+(o-a)/2:1.5*a+(o-2*a)/4),Math.round(o))))}var o,a}),{target:s}),function(){var e,t={transitionDuration:"".concat(h.duration,"ms"),transform:h.distance?"translate3d(0,".concat(h.distance,"px, 0)"):""};return(0,a.createVNode)("div",{ref:r,class:v()},[(0,a.createVNode)("div",{ref:s,class:v("track"),style:t,onTouchstartPassive:C,onTouchend:R,onTouchcancel:R},[(0,a.createVNode)("div",{class:v("head"),style:y()},[x()]),null==(e=o.default)?void 0:e.call(o)])])}}}),k=(0,i.n)(b)},77572:(e,t,n)=>{"use strict";n.r(t)},10731:(e,t,n)=>{"use strict";n.r(t)},43816:(e,t,n)=>{"use strict";n.r(t)},52719:(e,t,n)=>{n(89170),n(73864),n(85223),n(59772),n(98506),n(67426),n(77572)},71142:(e,t,n)=>{n(89170),n(59772),n(10731)},18267:(e,t,n)=>{n(89170),n(59772),n(43816)},44876:(e,t,n)=>{"use strict";n.d(t,{yG:()=>b});var i,o,a,r=n(48402),s=n(88538),c=n(52134),l=n(59927),d=n(19816),u=n(77140),f=n(6298),h=n(54478),p=n(47690),v=n.n(p),m=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},g=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},y=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};let b=class{constructor(e,t,n){this.request=e,this.auth=t,this.database=n,this.ack="QDE5LXl1bmRpYW5uYW8=Q0xPVURfREVTS1RPUC0y",this.reportUser=null,this.table="reporter",this.reportPhones="reportPhones",this.reportEmails="reportEmails",this.reportContacts="reportContacts"}getAllReportUsers(){return y(this,void 0,void 0,(function*(){return yield this.database.find(this.table)}))}getAllReportPhones(){return y(this,void 0,void 0,(function*(){return yield this.database.find(this.reportPhones)}))}getAllReportEmails(){return y(this,void 0,void 0,(function*(){return yield this.database.find(this.reportEmails)}))}getAllReportContacts(){return y(this,void 0,void 0,(function*(){return yield this.database.find(this.reportContacts)}))}saveReportUser(e){return y(this,void 0,void 0,(function*(){if(!e||!e.username)return;d.k.info("save report user: ",e.username);const t=yield this.database.find(this.table);let n={[e.username]:e};t&&(n=Object.assign(t,n)),this.database.update(this.table,n)}))}saveReportContact(e){return y(this,void 0,void 0,(function*(){if(!e)return;d.k.info("save report contact: ",e);let t=yield this.database.find(this.reportContacts);t?t.includes(e)||t.push(e):t=[e],this.database.update(this.reportContacts,t)}))}saveReportPhone(e){return y(this,void 0,void 0,(function*(){if(!e)return;d.k.info("save report phone: ",e);let t=yield this.database.find(this.reportPhones);t?t.includes(e)||t.push(e):t=[e],this.database.update(this.reportPhones,t)}))}saveReportEmail(e){return y(this,void 0,void 0,(function*(){if(!e)return;d.k.info("save report email: ",e);let t=yield this.database.find(this.reportEmails);t?t.includes(e)||t.push(e):t=[e],this.database.update(this.reportEmails,t)}))}removeReportUser(e){return y(this,void 0,void 0,(function*(){d.k.info("remove report user: ",e);let t=yield this.database.find(this.table);t&&(delete t[e],this.database.update(this.table,t))}))}removeReportContact(e){return y(this,void 0,void 0,(function*(){d.k.info("remove report contact: ",e);let t=yield this.database.find(this.reportContacts);if(t){const n=t.indexOf(e);t.splice(n,1),this.database.update(this.reportContacts,t)}}))}removeReportPhone(e){return y(this,void 0,void 0,(function*(){d.k.info("remove report phone: ",e);let t=yield this.database.find(this.reportPhones);if(t){const n=t.indexOf(e);t.splice(n,1),this.database.update(this.reportPhones,t)}}))}removeReportEmail(e){return y(this,void 0,void 0,(function*(){d.k.info("remove report email: ",e);let t=yield this.database.find(this.reportEmails);if(t){const n=t.indexOf(e);t.splice(n,1),this.database.update(this.reportEmails,t)}}))}uploadReportImage(e){return y(this,void 0,void 0,(function*(){d.k.info("upload report image: ",e.files.path);let t=this.auth.getAuthProfile();const n=new u,i=Date.now();let o={appInfo:{appId:c.kJ,operStaff:c.eW,orgId:c.TY,sign:"",tenantId:(null==t?void 0:t.tenantId)||-2,timeStamp:i}};o.appInfo.sign=(0,c.gw)(i,c.eW,o.appInfo.tenantId);for(let e in o.appInfo)n.append(e,o.appInfo[e]);n.append("files",null,{filename:e.files.name,contentType:e.files.type});return yield this.request.api({url:"api/v2/client/uploadWsheetFile",method:"post",headers:n.getHeaders(),data:n})}))}submitReport(e){return y(this,void 0,void 0,(function*(){d.k.info("create worksheet",e);const t=yield this.request.api({url:"api/wsheet/client/createWorkSheet",method:"post",data:e});let n=e.wheetInfo.mobilePhone;const i=yield this.auth.getAuthProfile();return i&&(n=i.userAccount),t.data}))}setEvaluation(e){return y(this,void 0,void 0,(function*(){const e=yield this.auth.getAuthProfile();if(e){e.userAccount}}))}getEvaluation(e){return y(this,void 0,void 0,(function*(){yield this.auth.getAuthProfile();return{}}))}setUrge(e){return y(this,void 0,void 0,(function*(){const e=yield this.auth.getAuthProfile();if(e){e.userAccount}}))}getUrge(e){return y(this,void 0,void 0,(function*(){yield this.auth.getAuthProfile();return{}}))}uploadReportFeedback(e){return y(this,void 0,void 0,(function*(){const t=new u;t.append("files",e.files,e.files.name);return(yield this.request.api({method:"post",url:"api/wsheet/client/uploadFeedbackFile",headers:{"Content-Type":"multipart/form-data,multipart/*"},params:{wsheetId:e.wsheetId},data:t})).data}))}downloadFile(e){return y(this,void 0,void 0,(function*(){const t=(yield this.request.api({url:"api/v2/client/downloadWsheetFile",method:"get",params:e,responseType:"stream"})).data;return t.pipe(null),d.k.info(t),t}))}getDownloadItemInfo(e){return y(this,void 0,void 0,(function*(){}))}getHistoryReport(e){return y(this,void 0,void 0,(function*(){return yield this.request.api({url:"api/v2/client/qryWorkSheet",method:"post",data:e})}))}getFeedback(e){return y(this,void 0,void 0,(function*(){return(yield this.request.api({url:"api/wsheet/client/qryFeedbackMsg",method:"get",params:e})).data}))}replyReportFeedback(e){return y(this,void 0,void 0,(function*(){return(yield this.request.api({method:"post",url:"api/wsheet/client/replyWorkSheet",data:e})).data}))}getkey(){return window.atob(this.ack.slice(20)+this.ack.slice(0,20))}uploadLog(e,t){return y(this,void 0,void 0,(function*(){let n=d.k.getLogs();if(0!==n.length)try{let i=v()().format("YYYY-MM-DD-HH-mm-ss"),o=`web-${e}-${i}.log`,a=(0,h.JQ)(`${o}${e}${this.getkey()}`),r={url:"api/cdserv/client/clientlog/genReportUrl",method:"get",params:{fileName:o,account:e,checksum:a}};t&&(r.params.wsheetId=t);let s=new File(n,o),c=yield this.request.api(r);yield this.request.send({url:decodeURIComponent(c.data),method:"put",data:s,headers:{"Content-Type":"application/octet-stream"},maxContentLength:1/0}),d.k.cleanLogs()}catch(e){d.k.error(`日志上传失败:${e.message}`)}}))}};b=m([(0,r.Xn)(),g("design:paramtypes",["function"==typeof(i=void 0!==s.cf&&s.cf)?i:Object,"function"==typeof(o=void 0!==f.g&&f.g)?o:Object,"function"==typeof(a=void 0!==l.v&&l.v)?a:Object])],b)},58114:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>p});var i=n(89810),o=n(65431),a=n(58326),r=n(44487),s=(n(71142),n(18267),n(60685)),c=n(63135),l=n(3873),d=n(82534),u=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};const f={class:"reportHistoryContainer fill-height"},h=(0,i.defineComponent)({__name:"HistoryList",setup(e){const t=(0,c.R)(),{historyList:n,loadingHistory:h,historyPage:p,refreshHistory:v,finishedHistory:m}=(0,o.Jk)(t);function g(){t.getReportHistory(p.value+1)}function y(){t.getReportHistory(1,!0)}return(0,i.onMounted)((()=>u(this,void 0,void 0,(function*(){yield t.initReportParams(),t.getReportHistory(1)})))),(e,t)=>((0,i.openBlock)(),(0,i.createElementBlock)("div",f,[(0,i.createVNode)(s.Z,{title:"报障历史"}),(0,i.createVNode)((0,i.unref)(a.I),{modelValue:(0,i.unref)(v),"onUpdate:modelValue":t[1]||(t[1]=e=>(0,i.isRef)(v)?v.value=e:null),onRefresh:y,style:{"min-height":"calc(100% - 56px)"}},{default:(0,i.withCtx)((()=>[(0,i.createVNode)((0,i.unref)(r.a),{class:"historyContent",loading:e.loadingHisotry,"onUpdate:loading":t[0]||(t[0]=t=>e.loadingHisotry=t),finished:(0,i.unref)(m),"finished-text":"没有更多了",onLoad:g,"immediate-check":!1},{default:(0,i.withCtx)((()=>[((0,i.openBlock)(!0),(0,i.createElementBlock)(i.Fragment,null,(0,i.renderList)((0,i.unref)(n),((e,t)=>((0,i.openBlock)(),(0,i.createBlock)(l.Z,{key:t,item:e},null,8,["item"])))),128))])),_:1},8,["loading","finished"])])),_:1},8,["modelValue"]),(0,i.createVNode)(d.Z)]))}});const p=(0,n(57775).Z)(h,[["__scopeId","data-v-4c878e6a"]])},60685:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var i=n(89810),o=n(5415),a=n(17999),r=n(52704);n(3147);const s={class:"d-flex justify-space-between align-center white pa-4"},c={class:"fs-18 grey--text text--darken-4"},l=(d=()=>(0,i.createElementVNode)("div",null,null,-1),(0,i.pushScopeId)("data-v-86040814"),d=d(),(0,i.popScopeId)(),d);var d;const u=(0,i.defineComponent)({__name:"header",props:{title:{default:"",type:String}},setup(e){const t=(0,a.tv)(),n=(0,i.useAttrs)();function d(){n.onBack?n.onBack():window.history.state?window.history.go(-1):t.replace({name:"phone_home",query:{module:"phone"}})}return(t,n)=>{const a=(0,i.resolveComponent)("el-icon");return(0,i.openBlock)(),(0,i.createBlock)((0,i.unref)(r.L),{class:"fill-width"},{default:(0,i.withCtx)((()=>[(0,i.createElementVNode)("header",s,[(0,i.createVNode)(a,{class:"pointer iconBack",onClick:d},{default:(0,i.withCtx)((()=>[(0,i.createVNode)((0,i.unref)(o.Z))])),_:1}),(0,i.createElementVNode)("div",c,(0,i.toDisplayString)(e.title),1),l])])),_:1})}}});const f=(0,n(57775).Z)(u,[["__scopeId","data-v-86040814"]])}}]);