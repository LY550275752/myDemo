"use strict";(self.webpackChunkclink_web=self.webpackChunkclink_web||[]).push([[6811],{66811:(e,t,l)=>{l.r(t),l.d(t,{default:()=>q});var o=l(89810),n=l(48402),a=l(55304),c=l(73827),i=l(88533),r=l(5341),s=function(e,t,l,o){return new(l||(l=Promise))((function(n,a){function c(e){try{r(o.next(e))}catch(e){a(e)}}function i(e){try{r(o.throw(e))}catch(e){a(e)}}function r(e){var t;e.done?n(e.value):(t=e.value,t instanceof l?t:new l((function(e){e(t)}))).then(c,i)}r((o=o.apply(e,t||[])).next())}))};const d=e=>((0,o.pushScopeId)("data-v-74484f46"),e=e(),(0,o.popScopeId)(),e),u={class:"skin-desktop-manage desktop-manage"},m={class:"manage-info panel"},p={class:"info-title"},k={key:0,class:"iconfont icon-information"},v={class:"info-body desktop-info"},f={key:0},N=d((()=>(0,o.createElementVNode)("label",null,"编号:",-1))),V=d((()=>(0,o.createElementVNode)("label",null,"云电脑别名:",-1))),y={class:"rename-input"},E={class:"desktop-name"},B={class:"manage-info panel"},g={class:"info-title"},h={key:0,class:"iconfont icon-dispose"},D={key:0,class:"info-body config-info"},C={key:1,class:"info-body config-info"},x=d((()=>(0,o.createElementVNode)("i",{class:"iconfont icon-cpu"},null,-1))),I=d((()=>(0,o.createElementVNode)("i",{class:"iconfont icon-processor"},null,-1))),b=d((()=>(0,o.createElementVNode)("i",{class:"iconfont icon-system-disk"},null,-1))),w={class:"manage-info panel"},T={class:"info-title"},S={key:0,class:"iconfont icon-datadisk"},G={class:"info-body data-disk"},$=d((()=>(0,o.createElementVNode)("label",null,"容量:",-1))),j={key:0,class:"manage-info panel"},_={class:"info-title"},P={key:0,class:"iconfont icon-time"},F={class:"info-body"},M={class:"info-expire-time"},z={class:"manage-info-item"},L=d((()=>(0,o.createElementVNode)("label",null,"您已使用:",-1))),H=d((()=>(0,o.createElementVNode)("label",null,"剩余:",-1))),U={key:1,class:"manage-info panel"},A=d((()=>(0,o.createElementVNode)("h2",{class:"info-title"},"管理员联系方式",-1))),K={class:"info-body data-disk"},O={key:0},Y={key:1},Z=(0,o.defineComponent)({__name:"desktopManage",setup(e){const t=(0,r.mL)(),{desktop:l}=(0,o.inject)("$options"),{desktopList:d}=(0,o.inject)("$options"),Z=n.nC.get(a.hD),q=(0,o.inject)("$dialogHelper"),J=(0,o.ref)(null),Q=(0,o.ref)(!1),R=(0,o.ref)(!1),W=(0,o.ref)({}),X=(0,o.ref)(!1),ee=(0,o.ref)(!1),te=(0,o.ref)([]),le=(0,o.ref)(""),oe=(0,o.ref)(""),ne=(0,o.ref)(""),ae=(0,o.ref)(),ce=(0,o.ref)([]),ie=(0,o.ref)([]);function re(){var e,t,l,o;return s(this,void 0,void 0,(function*(){const n={desktopId:W.value.objId,objType:W.value.objType,objId:W.value.objId};try{X.value=!0;let a=yield Z.getHardwareFeature(n);if(a.dataDiskGB?Q.value=!1:Q.value=!0,te.value=a,a.createDate&&a.nowDate&&a.expireDate){le.value=function(e){const t=new Date(e),l=t.getFullYear(),o=t.getMonth()+1,n=t.getDate(),a=t.getHours();return`${l}年${o}月${n}日${a}时`}(a.expireDate),oe.value=me(a.createDate,a.nowDate);let e=a.expireDate-a.createDate,t=a.nowDate-a.createDate;t>=e?(ne.value=me(0,0),ae.value=100):(ne.value=me(t,e),ae.value=Math.ceil(100*t/e))}ce.value=(null===(t=null===(e=a.linkInfo)||void 0===e?void 0:e.linkPhone)||void 0===t?void 0:t.split(","))||[],ie.value=(null===(o=null===(l=a.linkInfo)||void 0===l?void 0:l.linkEmail)||void 0===o?void 0:o.split(","))||[]}catch(e){c.z8.error(e.message)}finally{X.value=!1}}))}function se(){R.value=!R.value,(0,o.nextTick)((()=>{J.value.focus()}))}function de(){return s(this,void 0,void 0,(function*(){if(W.value.desktopName=W.value.desktopName.trim(),""===W.value.desktopName)c.z8.warning("云电脑别名不能为空！");else if(W.value.desktopName.length>15)c.z8.warning("云电脑别名不能超过15个字！");else{const t=W.value.desktopId;var e=d.filter((function(e){return e.objId!==t}));try{e.length>0&&e.forEach((e=>{if(e.objName===W.value.desktopName)throw c.z8.warning("名称“"+W.value.desktopName+"”已被使用，请修改您的云电脑别名"),new Error("End")})),R.value=!R.value;const t={desktopId:W.value.desktopId,nickName:W.value.desktopName};try{if((yield Z.rename(t)).data){const e={desktopId:W.value.desktopId,objName:W.value.desktopName};i.$x.emit(i.eM.UPDATE_DESKTOP_NAME,e)}}catch(e){c.z8.warning(e.message),ue()}}catch(e){}}}))}function ue(){R.value=!1,W.value.desktopName=l.objName}function me(e,t){let l=36e5,o=864e5;return parseInt((t-e)/parseInt(o))+"天"+parseInt((t-e)%parseInt(o)/parseInt(l))+"时"+parseInt(parseInt((t-e)%parseInt(o)%parseInt(l))/parseInt(6e4))+"分钟"}return(0,o.onMounted)((()=>s(this,void 0,void 0,(function*(){(0,o.nextTick)((()=>s(this,void 0,void 0,(function*(){q.config({title:"天翼云电脑管理",width:480})})))),1===l.objType?ee.value=!0:ee.value=!1,W.value=l,W.value.desktopName=l.objName,yield re()})))),(e,l)=>{const n=(0,o.resolveComponent)("el-input"),a=(0,o.resolveComponent)("el-button"),c=(0,o.resolveComponent)("Edit"),i=(0,o.resolveComponent)("el-icon"),r=(0,o.resolveComponent)("el-progress"),s=(0,o.resolveDirective)("loading");return(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("section",u,[(0,o.createElementVNode)("div",m,[(0,o.createElementVNode)("h2",p,[(0,o.unref)(t)?((0,o.openBlock)(),(0,o.createElementBlock)("i",k)):(0,o.createCommentVNode)("",!0),(0,o.createTextVNode)("云电脑信息")]),(0,o.createElementVNode)("div",v,[(0,o.createElementVNode)("ul",null,[ee.value?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("li",f,[N,(0,o.createTextVNode)(" "+(0,o.toDisplayString)(W.value.desktopCode),1)])),(0,o.createElementVNode)("li",null,[V,(0,o.createElementVNode)("div",y,[R.value?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:0},[(0,o.createVNode)(n,{ref_key:"desktopNameInput",ref:J,maxlength:"15",modelValue:W.value.desktopName,"onUpdate:modelValue":l[0]||(l[0]=e=>W.value.desktopName=e),placeholder:W.value.desktopName},null,8,["modelValue","placeholder"]),(0,o.createVNode)(a,{type:"text",onClick:de,icon:"check"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("确认")])),_:1}),(0,o.createVNode)(a,{type:"text",onClick:ue},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("取消")])),_:1})],64)):((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:1},[!ee.value&&(0,o.unref)(t)?((0,o.openBlock)(),(0,o.createBlock)(i,{key:0,onClick:se},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c)])),_:1})):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("span",E,(0,o.toDisplayString)(W.value.desktopName),1),ee.value||(0,o.unref)(t)?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createBlock)(a,{key:1,type:"text",onClick:se,icon:"el-icon-edit"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("重命名")])),_:1}))],64))])])])])]),(0,o.createElementVNode)("div",B,[(0,o.createElementVNode)("h2",g,[(0,o.unref)(t)?((0,o.openBlock)(),(0,o.createElementBlock)("i",h)):(0,o.createCommentVNode)("",!0),(0,o.createTextVNode)("配置信息")]),(0,o.unref)(t)?((0,o.openBlock)(),(0,o.createElementBlock)("div",D,(0,o.toDisplayString)(te.value.cpuCore?`${te.value.cpuCore}核`:"--")+"/"+(0,o.toDisplayString)(te.value.memoryGB?`${te.value.memoryGB}GB内存`:"--")+"/"+(0,o.toDisplayString)(te.value.systemDiskGB?`${te.value.systemDiskGB}GB系统盘`:"--"),1)):((0,o.openBlock)(),(0,o.createElementBlock)("div",C,[(0,o.createElementVNode)("ul",null,[(0,o.createElementVNode)("li",null,[x,(0,o.createTextVNode)(" CPU: "+(0,o.toDisplayString)(te.value.cpuCore?`${te.value.cpuCore}核`:"--"),1)]),(0,o.createElementVNode)("li",null,[I,(0,o.createTextVNode)(" 内存："+(0,o.toDisplayString)(te.value.memoryGB?`${te.value.memoryGB}GB`:"--"),1)]),(0,o.createElementVNode)("li",null,[b,(0,o.createTextVNode)(" 系统盘："+(0,o.toDisplayString)(te.value.systemDiskGB?`${te.value.systemDiskGB}GB`:"--"),1)])])]))]),(0,o.createElementVNode)("div",w,[(0,o.createElementVNode)("h2",T,[(0,o.unref)(t)?((0,o.openBlock)(),(0,o.createElementBlock)("i",S)):(0,o.createCommentVNode)("",!0),(0,o.createTextVNode)("数据盘")]),(0,o.createElementVNode)("div",G,[(0,o.createElementVNode)("ul",null,[(0,o.createElementVNode)("li",null,[$,(0,o.createTextVNode)(" "+(0,o.toDisplayString)(Q.value?"无数据盘":`${te.value.dataDiskGB}GB`),1)])])])]),te.value.createDate?((0,o.openBlock)(),(0,o.createElementBlock)("div",j,[(0,o.createElementVNode)("h2",_,[(0,o.unref)(t)?((0,o.openBlock)(),(0,o.createElementBlock)("i",P)):(0,o.createCommentVNode)("",!0),(0,o.createTextVNode)("使用时长")]),(0,o.createElementVNode)("div",F,[(0,o.createElementVNode)("p",M,(0,o.toDisplayString)(le.value)+"到期",1),(0,o.createVNode)(r,{percentage:ae.value,"show-text":!1},null,8,["percentage"]),(0,o.createElementVNode)("ul",z,[(0,o.createElementVNode)("li",null,[L,(0,o.createTextVNode)(" "+(0,o.toDisplayString)(oe.value),1)]),(0,o.createElementVNode)("li",null,[H,(0,o.createTextVNode)(" "+(0,o.toDisplayString)(ne.value),1)])])])])):(0,o.createCommentVNode)("",!0),te.value.linkInfo&&te.value.linkInfo.linkPhone||te.value.linkInfo&&te.value.linkInfo.linkEmail?((0,o.openBlock)(),(0,o.createElementBlock)("div",U,[A,(0,o.createElementVNode)("div",K,[te.value.linkInfo.linkPhone?((0,o.openBlock)(),(0,o.createElementBlock)("ul",O,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(ce.value,((e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)("li",{key:t},"手机号:"+(0,o.toDisplayString)(e),1)))),128))])):(0,o.createCommentVNode)("",!0),te.value.linkInfo.linkEmail?((0,o.openBlock)(),(0,o.createElementBlock)("ul",Y,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(ie.value,((e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)("li",{key:t},"邮箱:"+(0,o.toDisplayString)(e),1)))),128))])):(0,o.createCommentVNode)("",!0)])])):(0,o.createCommentVNode)("",!0)])),[[s,X.value]])}}});const q=(0,l(57775).Z)(Z,[["__scopeId","data-v-74484f46"]])}}]);