"use strict";(self.webpackChunkclink_web=self.webpackChunkclink_web||[]).push([[7669],{94110:(e,t,o)=>{o.d(t,{u:()=>m});var n=o(65431),a=o(89810),l=o(91308),i=o(57524),r=o(99143),c=o(65050),s=o(78125),d=o(17999),u=o(9021),f=o(52134),p=o(48402),h=o(6298),v=function(e,t,o,n){return new(o||(o=Promise))((function(a,l){function i(e){try{c(n.next(e))}catch(e){l(e)}}function r(e){try{c(n.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,r)}c((n=n.apply(e,t||[])).next())}))};const m=(0,n.Q_)("base",(()=>{const e=p.nC.get(h.g),t=(0,d.yj)(),o=(0,d.tv)(),m=(0,a.ref)("phone"),g=(0,u.C)(),{logged:y}=(0,n.Jk)(g),k=(0,a.ref)([{name:"云手机",id:"phone",icon:l.Z},{name:"我",id:"me",icon:i.Z}]),w=(0,a.computed)((()=>[{name:"账号与安全",id:"account",icon:i.Z,color:"#3296FF",visible:y.value},{name:"报障",id:"report",icon:r.Z,color:"#FFB43C",visible:!0},{name:"帮助手册",id:"help",icon:c.Z,color:"#3296FF",visible:!0},{name:"关于",id:"about",icon:s.Z,color:"#3296FF",visible:!0}])),b=(0,a.ref)(!1);return{currentModule:m,modules:k,features:w,showPanel:b,changeModule:function(e){m.value=e,o.replace({query:{module:e}})},initCurrentModule:function(){t.query.module&&(m.value=t.query.module.toString())},handleBack:function(e,t){window.history.state?window.history.go(-1):t?o.replace(e):o.push(e)},updateShowPanel:function(e){b.value=!!e},getAppInfo:function(){return v(this,void 0,void 0,(function*(){const t=Date.now();let o={appId:f.kJ,operStaff:f.eW,orgId:f.TY,sign:"",tenantId:-2,timeStamp:t};const n=yield e.getAuthProfile();return n&&(o.tenantId=n.tenantId),o.sign=(0,f.gw)(t,f.eW,o.tenantId),o}))}}}))},11824:(e,t,o)=>{o.d(t,{LQ:()=>u.LQ,Xn:()=>v,c_:()=>u.c_,l9:()=>u.l9,w4:()=>u.w4});var n,a,l,i=o(48402),r=o(55304),c=o(59927),s=o(6298),d=o(19816),u=o(96839),f=function(e,t,o,n){var a,l=arguments.length,i=l<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var r=e.length-1;r>=0;r--)(a=e[r])&&(i=(l<3?a(i):l>3?a(t,o,i):a(t,o))||i);return l>3&&i&&Object.defineProperty(t,o,i),i},p=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},h=function(e,t,o,n){return new(o||(o=Promise))((function(a,l){function i(e){try{c(n.next(e))}catch(e){l(e)}}function r(e){try{c(n.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,r)}c((n=n.apply(e,t||[])).next())}))};let v=class{constructor(e,t,o){this.desktop=e,this.auth=t,this.database=o,this.desktopId=null;const{desktopId:n}=this.desktop.connection.desktop;this.desktopId=n}updateDisplayStrategy(e){this.desktopId||(this.desktopId=this.desktop.connection.desktop.desktopId),sessionStorage.setItem(`displayStrategy-${this.desktopId}`,JSON.stringify(e)),d.k.info("存储画面显示策略到database");const t=this.getTableName();t&&this.database.update(t,e)}getTableName(){const e=this.auth.getAuthProfile();return e?`${e.userAccount}_${this.desktopId}_displayStrategy`:""}getDisplayStrategy(){return h(this,void 0,void 0,(function*(){this.desktopId||(this.desktopId=this.desktop.connection.desktop.desktopId);let e=sessionStorage.getItem(`displayStrategy-${this.desktopId}`);const t=this.getTableName();if(t){const e=yield this.database.find(t);if(e)return e}return e&&JSON.parse(e)||null}))}removeDisplayStrategy(){if(!this.desktopId)return;sessionStorage.removeItem(`displayStrategy-${this.desktopId}`);const e=this.getTableName();e&&this.database.remove(e)}};v=f([(0,i.Xn)(),p("design:paramtypes",["function"==typeof(n=void 0!==r.hD&&r.hD)?n:Object,"function"==typeof(a=void 0!==s.g&&s.g)?a:Object,"function"==typeof(l=void 0!==c.v&&c.v)?l:Object])],v)},49320:(e,t,o)=>{o.r(t),o.d(t,{default:()=>Vo});var n=o(89810),a=o(65431),l=o(28706),i=o(48402),r=o(11824);const c=o.p+"imgs/phoneLoading.d1042a.gif";var s=o(10074),d=o(27258),u=o(17999),f=o(55304),p=function(e,t,o,n){return new(o||(o=Promise))((function(a,l){function i(e){try{c(n.next(e))}catch(e){l(e)}}function r(e){try{c(n.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,r)}c((n=n.apply(e,t||[])).next())}))};const h={class:"phoneLoadingContainer"};var v;const m=[(v=()=>(0,n.createElementVNode)("i",{class:"fs-20 cloudphonefont icon-chevron-left"},null,-1),(0,n.pushScopeId)("data-v-5b4e0182"),v=v(),(0,n.popScopeId)(),v)],g={class:"d-flex flex-column align-center justify-center loadingContent"},y=["src"],k={class:"white--text"},w=(0,n.defineComponent)({__name:"phoneLoading",setup(e){i.nC.get(f.hD);const t=(0,s.n)(),{msg:o,isError:l}=(0,a.Jk)(t),r=((0,u.tv)(),(0,u.yj)());function v(){t.exit(String(r.query.id))}function w(){t.exit(String(r.query.id))}return(0,n.onMounted)((()=>p(this,void 0,void 0,(function*(){yield t.getDesktopState(),t.connectDesktop(),t.registerListener()})))),(e,t)=>{const a=(0,n.resolveComponent)("el-icon");return(0,n.openBlock)(),(0,n.createElementBlock)("div",h,[(0,n.createElementVNode)("div",{class:"backToList d-flex justify-center align-center pointer",onClick:v},m),(0,n.createElementVNode)("div",g,[(0,n.createElementVNode)("img",{src:(0,n.unref)(c),alt:"Loading",class:"loading mb-10"},null,8,y),(0,n.createElementVNode)("span",k,(0,n.toDisplayString)((0,n.unref)(o)),1),(0,n.unref)(l)?((0,n.openBlock)(),(0,n.createBlock)(a,{key:0,size:36,onClick:w},{default:(0,n.withCtx)((()=>[(0,n.createVNode)((0,n.unref)(d.Z))])),_:1})):(0,n.createCommentVNode)("",!0)])])}}});var b=o(57775);const C=(0,b.Z)(w,[["__scopeId","data-v-5b4e0182"]]);var V=o(14334),N=o(19816),x=o(5341),E=o(63102),_=o(10483),B=o(11299),R=o(97471),S=o(92720);const D=(0,a.Q_)("screen",(()=>{const e=(0,n.ref)(!0),t=(0,n.ref)({width:0,height:0}),o=(0,n.ref)({width:0,height:0});(0,n.ref)({width:0,height:0});return{realRatio:(0,n.computed)((()=>o.value.width&&o.value.height?o.value.width/o.value.height:1)),screenSize:t,phoneSize:o,isVertical:e,updateVertical:function(t){e.value=t},updateScreenSize:function(e){t.value=(0,S.cloneDeep)(e)},updatePhoneSize:function(e){o.value=(0,S.cloneDeep)(e)},toggleVertical:function(){e.value=!e.value,e.value}}})),I=["onMousedown","onMousemove","onMouseup","onTouchstart","onTouchmove","onTouchend","onMouseout","onMouseleave","onMouseover","onWheel","onKeydown","onKeyup","onDrop"],F=(e=>((0,n.pushScopeId)("data-v-bf229b78"),e=e(),(0,n.popScopeId)(),e))((()=>(0,n.createElementVNode)("div",{class:"cursor__content"},null,-1))),P=[F],M=(0,n.defineComponent)({__name:"screen",setup(e){const t=i.nC.get(V.WY),o=i.nC.get(f.hD),r=(0,n.ref)(null),c=l.N.get(_.C),s=l.N.get(B.I),d=l.N.get(R.g),u=D(),{realRatio:p,phoneSize:h,isVertical:v}=(0,a.Jk)(u),m=((0,n.ref)(null),(0,n.ref)(null));V.TM.SHOW;let g=0;function y(e,t){r.value.style.width=`${e}px`,r.value.style.height=`${t}px`}function k(e){r.value.blur()}function w(e){r.value.focus()}function b(){var e;"1"===o.connectionInfo.clipBoardIn&&(0,n.nextTick)((()=>{s.sendClipboard()})),null===(e=m.value)||void 0===e||e.style.setProperty("opacity","1")}function C(e){t.releaseAllKey(),m.value.style.setProperty("opacity","0")}function N(e){$(e,V.PO.DOWN),m.value.style.setProperty("scale","0.9")}function S(e){$(e,V.PO.UP),m.value.style.setProperty("scale","1")}function F(e){$(e,V.PO.MOVE);const{offsetLeft:t,offsetTop:o,offsetWidth:n,offsetHeight:a}=e.target;let l=Math.floor(e.clientX-t),i=Math.floor(e.clientY-o);if(!v.value){let t=(window.innerWidth-a)/2,o=(window.innerHeight-n)/2;l=Math.floor(window.innerHeight-e.clientY-o),i=Math.floor(e.clientX-t)}m.value.style.setProperty("top",`${i}px`),m.value.style.setProperty("left",`${l}px`)}function M(e){Z(e,V.wn.DOWN)}function T(e){Z(e,V.wn.MOVE)}function O(e){Z(e,V.wn.UP)}function j(e){let o=e.keyCode;229===o&&E.aT[e.code]&&(o=E.aT[e.code]),t.keyboard({type:V.Jz.DOWN,key:o}),x.V5&&(20===e.keyCode||e.metaKey&&"MetaLeft"!==e.code&&"MetaRight"!==e.code)&&t.keyboard({type:V.Jz.UP,key:e.keyCode})}function W(e){x.V5&&20===e.keyCode&&t.keyboard({type:V.Jz.DOWN,key:e.keyCode}),t.keyboard({type:V.Jz.UP,key:e.keyCode})}function H(e){let o=e.deltaY,n=Math.abs(o);if(n<100&&(g+=n,g<100))return;g=0;let a=o>0?V.tc.WHEEL_DOWN:V.tc.WHEEL_UP,l={display_id:0,type:V.PO.DOWN,button:a,x:e.offsetX,y:e.offsetY};l.type=V.PO.DOWN,t.mouse(l),l.type=V.PO.UP,t.mouse(l)}function U(e){if("1"!==o.connectionInfo.dragFileIn)return;if(!e.dataTransfer)return;let n=e.dataTransfer.items;for(let e=0;e<n.length;e++){let o=n[e].webkitGetAsEntry();if(o&&o.isFile)return void o.file((e=>{t.dragdrop(e)}))}}function $(e,t){d.sendMouseEvent(e,t)}function Z(e,o){document.activeElement!==r.value&&r.value.focus();let n=Array.from(e.changedTouches)[0];const{offsetLeft:a,offsetTop:l,offsetHeight:i,offsetWidth:c}=n.target,s=(0,E.DO)(h.value.width,h.value.height,v.value);let d={x:n.clientX,y:n.clientY,id:n.identifier,type:o};if(v.value)d.x=(n.clientX-a)/s,d.y=(n.clientY-l)/s;else{let e=(window.innerWidth-i)/2,t=(window.innerHeight-c)/2;d.x=(window.innerHeight-n.clientY-t)/s,d.y=(n.clientX-e)/s}if(t.touch({items:[d]}),o===V.wn.DOWN){let e={type:V.PO.MOVE,button:V.tc.LEFT,display_id:0,x:d.x,y:d.y};t.mouse(e)}}return(0,n.onMounted)((()=>{!function(){t.onMouseState.on((e=>{let{state:t,display_id:o}=e})),t.onClinkStateChange.on((e=>{e.state===V.j4.CONNECTED&&r.value.focus()})),document.addEventListener("dragover",(e=>{e.preventDefault()}));let e=c.onUpdateDisplaySize.on((e=>{let{styleHeight:t,styleWidth:o}=e,n=o,a=t;v.value||(n=t,a=o),(0,E.Kl)(h.value.width,h.value.height,v.value)?y(n,n/p.value):y(a*p.value,a)}));(0,n.onUnmounted)((()=>{e&&e.dispose()}))}()})),(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",{class:"screenContainer ma-auto",ref_key:"screen",ref:r,tabindex:"0",onMousedown:(0,n.withModifiers)(N,["prevent"]),onMousemove:(0,n.withModifiers)(F,["prevent"]),onMouseup:(0,n.withModifiers)(S,["prevent"]),onTouchstart:(0,n.withModifiers)(M,["prevent"]),onTouchmove:(0,n.withModifiers)(T,["prevent"]),onTouchend:(0,n.withModifiers)(O,["prevent"]),onContextmenu:t[0]||(t[0]=(0,n.withModifiers)((()=>{}),["prevent"])),onMouseout:(0,n.withModifiers)(k,["prevent"]),onMouseleave:(0,n.withModifiers)(C,["prevent"]),onMouseover:(0,n.withModifiers)(w,["prevent"]),onWheel:(0,n.withModifiers)(H,["prevent"]),onKeydown:(0,n.withModifiers)(j,["prevent"]),onKeyup:(0,n.withModifiers)(W,["prevent"]),onFocus:b,onDrop:(0,n.withModifiers)(U,["prevent","stop"]),onDropover:t[1]||(t[1]=(0,n.withModifiers)((()=>{}),["prevent","stop"]))},[(0,n.createElementVNode)("div",{id:"cursor",class:"cursor",ref_key:"cursorRef",ref:m},P,512)],40,I))}}),T=(0,b.Z)(M,[["__scopeId","data-v-bf229b78"]]),O=(0,n.defineComponent)({__name:"display",setup(e){const t=i.nC.get(V.WY),o=D(),{realRatio:r,phoneSize:c,isVertical:s}=(0,a.Jk)(o),d=(0,n.ref)(null),u=(0,n.ref)(null),f=(0,n.ref)(null),p=(0,n.ref)(null),h=(0,n.ref)(x.V5),v=(0,n.ref)(!1),m=l.N.get(_.C),g=(0,n.ref)(0);let y=null,k=null,w=[],b=null,C=!0;function B(){t.onDisplayChange.on((e=>{!function(e,t){if(!y)return;let n=y.getImageData(0,0,u.value.width,u.value.height);g.value=t,o.updatePhoneSize({width:e,height:t}),u.value.width=e,u.value.height=t,f.value.width=e,f.value.height=t,p.value.width=e,p.value.height=t,y.putImageData(n,0,0)}(e.width,e.height)})),t.onImageUpdate.on((e=>{0===e.display_id&&(e.type!==V.__.IMAGE?e.type!==V.__.STREAM||function(e){if(!b||!C)return void w.push(e.data);C=!1,b.appendBuffer(e.data)}(e):function(e){if(!y)return void N.k.error("canvas 2d context not support!");if(e.data instanceof Uint8ClampedArray){let t=new ImageData(e.data,e.w,e.h);y.putImageData(t,e.x,e.y)}else x.V5?y.drawImage(e.data,e.x,e.y):(f.value.width=e.w,f.value.height=e.h,k&&(k.drawImage(e.data,0,0),y.putImageData(k.getImageData(0,0,e.w,e.h),e.x,e.y)));m.setLastFrame(e)}(e))})),t.onStreamState.on((e=>{N.k.info(`onStreamState: ${e.state}`),1===e.state?(function(e){new Promise(((t,o)=>{b=null,w=[];let n=new MediaSource,a=e===V.gT.SPICE_VIDEO_CODEC_TYPE_H264?'video/mp4; codecs="avc1.42c020"':'video/webm; codecs="vp8"';N.k.info("mimeCodec",a),p.value.src&&URL.revokeObjectURL(p.value.src),p.value.src=URL.createObjectURL(n),n.addEventListener("sourceopen",(()=>{let e=b=n.addSourceBuffer(a);e.addEventListener("updateend",(()=>{T(e)})),e.addEventListener("error",(()=>{N.k.error("sourceBuffer error")})),t(e),T(e)})),n.addEventListener("sourceclose",(()=>{N.k.error("sourceclose")})),n.addEventListener("sourceended",(()=>{N.k.error("sourceended")}))}))}(e.codecs),v.value=!0):(!function(){if(!y)return;y.drawImage(p.value,0,0),N.k.info("capture video")}(),v.value=!1,b=null,w=[])}));let e=m.onUpdateDisplaySize.on((e=>{if(!p.value)return;let{styleWidth:t,styleHeight:n}=e;o.updateScreenSize({width:t,height:n});let a=t,l=n;s.value||(a=n,l=t),(0,E.Kl)(c.value.width,c.value.height,s.value)?O(a,a/r.value):O(l*r.value,l)}));(0,n.onUnmounted)((()=>{e&&e.dispose()}))}function R(){N.k.warn("webglcontextcreationerror")}function S(){N.k.warn("webglcontextlost")}function I(){N.k.warn("webglcontextrestored")}function F(){var e;N.k.warn(`video pause:${null===(e=p.value)||void 0===e?void 0:e.paused}`)}function P(){}function M(){let e="";p.value.error&&(e=p.value.error.message),N.k.error(`video error: ${e}`),v.value&&(N.k.info("refresh stream"),t.pause(),setTimeout((()=>{t.resume()}),20))}function T(e){if(p.value.paused&&p.value.readyState>=2){p.value.play()}if(C=function(){if(!b)return!1;let e=b.buffered;if(e.length<1)return!0;let t=e.start(0),o=e.end(0),n=p.value.currentTime,a=0,l=o-n;if(n<t)return N.k.info(`set video currentTime ${t}`),p.value.currentTime=t,!0;l>.3&&1.5!==p.value.playbackRate?(N.k.info("set video rate 1.5"),p.value.playbackRate=1.5):l<.06&&1!==p.value.playbackRate&&(N.k.info("set video rate 1"),p.value.playbackRate=1);n-t>10&&(a=n-5);if(0===a)return!0;return N.k.info(`remove video cache ${t}, ${a}`),b.remove(t,a),!1}(),!C)return;let t=w.shift();t?(C=!1,e.appendBuffer(t)):C=!0}function O(e,t){u.value.style.width=`${e}px`,u.value.style.height=`${t}px`,f.value.style.width=`${e}px`,f.value.style.height=`${t}px`,p.value.style.width=`${e}px`,p.value.style.height=`${t}px`,d.value.style.width=`${e}px`,d.value.style.height=`${t}px`}return(0,n.onMounted)((()=>{(0,n.nextTick)((()=>{y=u.value.getContext("2d"),k=f.value.getContext("2d"),m.resizeWindow(),B()}))})),(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",{class:"display-wrapper grey ma-auto",ref_key:"displayRef",ref:d},[(0,n.createElementVNode)("canvas",{class:"background",ref_key:"backgroundRef",ref:f},null,512),(0,n.createElementVNode)("canvas",{class:(0,n.normalizeClass)(["canvas",{pixelated:h.value}]),ref_key:"canvasRef",ref:u,onWebglcontextcreationerror:R,onWebglcontextlost:S,onWebglcontextrestored:I},null,34),(0,n.withDirectives)((0,n.createElementVNode)("video",{muted:"",autoplay:"",class:(0,n.normalizeClass)([{pixelated:h.value},"video"]),ref_key:"videoRef",ref:p,onPause:F,onEnded:P,onError:M},null,34),[[n.vShow,v.value]])],512))}}),j=(0,b.Z)(O,[["__scopeId","data-v-3bcfb02e"]]);var W=o(10111),H=o(88533),U=o(64566),$=o(91840),Z=(o(34564),o(15807),function(e,t,o,n){return new(o||(o=Promise))((function(a,l){function i(e){try{c(n.next(e))}catch(e){l(e)}}function r(e){try{c(n.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,r)}c((n=n.apply(e,t||[])).next())}))});const L=["onClick"],z={key:0,class:"cloudphonefont icon-checkbox-marked-circle"},J={class:"qualityContent d-flex align-center justify-center pa-3 pointer"},A=(e=>((0,n.pushScopeId)("data-v-c1d3665e"),e=e(),(0,n.popScopeId)(),e))((()=>(0,n.createElementVNode)("span",{style:{color:"#787878",transform:"scale(0.83)"}},"画质",-1))),G={class:"ml-2 fs-14 text"},q=(0,n.defineComponent)({__name:"quality",setup(e){const t=i.nC.get(f.hD),o=i.nC.get(r.Xn),a=i.nC.get(V.WY),l=(0,n.ref)(r.w4.good),c=(0,n.ref)([{text:"标清",value:r.w4.general},{text:"高清",value:r.w4.good},{text:"超清",value:r.w4.excellent}]),s=(0,n.ref)(!1),d=(0,n.computed)((()=>c.value[l.value-1].text)),u=(0,n.ref)({flowChartConfig:r.c_.flowChartConfig,videoFrameRatio:r.c_.videoFrameRatio,videoQuality:r.c_.videoQuality});function p(e,n){return Z(this,void 0,void 0,(function*(){e===r.w4.general&&(u.value=Object.assign(Object.assign({},u.value),{videoFrameRatio:r.c_.videoFrameRatio,videoQuality:r.c_.videoQuality})),e===r.w4.good&&(u.value=Object.assign(Object.assign({},u.value),{videoFrameRatio:r.LQ.videoFrameRatio,videoQuality:r.LQ.videoQuality})),e===r.w4.excellent&&(u.value=Object.assign(Object.assign({},u.value),{videoFrameRatio:r.l9.videoFrameRatio,videoQuality:r.l9.videoQuality}));const{objId:i}=t.connection.desktop,s={desktopId:i,setting:Object.assign({mode:l.value},u.value)};try{yield o.updateDisplayStrategy(s);let e=c.value.find((e=>e.value===l.value));n||(U.F.success(`画质已调整为 ${null==e?void 0:e.text}`),N.k.info("画面设置-成功",s));const t=Object.assign({},u.value);!n&&N.k.info("画面设置-display-setting",t),a.setDisplaySetting(t)}catch(e){U.F.fail("画面设置-失败"),N.k.error("画面设置-设置缓存显示策略失败：",e)}}))}return(0,n.onMounted)((()=>{!function(){Z(this,void 0,void 0,(function*(){const{desktopId:e}=t.connection.desktop;let n=!1;const a=yield o.getDisplayStrategy();if(N.k.info("画面设置-获取缓存显示策略localSetting",a),a){const e=a;if(e&&e.setting){const t=e.setting;N.k.info("画面设置-有缓存显示策略",t),t.mode&&(l.value=t.mode),t.strategy&&(l.value=t.strategy),4===t.strategy&&(l.value=3),t.videoFrameRate&&(u.value.videoFrameRatio=t.videoFrameRate),t.videoFrameRatio&&(u.value.videoFrameRatio=t.videoFrameRatio),t.videoQuality&&(u.value.videoQuality=t.videoQuality),n=!0}else N.k.info("画面设置-无缓存显示策略"),n=!1}if(e)try{const o=yield t.getDesktopStrategy(e);if(N.k.info("画面设置-业管显示策略：",o),o.showStrategy){let e=JSON.parse(o.showStrategy);N.k.info("画面设置-转换业管显示策略成功：",e),n||(p(r.w4.good,!0),l.value=2)}else N.k.info("画面设置-不存在业管显示策略")}catch(e){N.k.error("业管显示策略获取失败")}N.k.info("画面设置-显示策略数据：",l.value,u.value)}))}()})),(e,t)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)($.J),{show:s.value,"onUpdate:show":t[0]||(t[0]=e=>s.value=e),theme:"dark","show-arrow":!1,offset:[0,0]},{reference:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",J,[A,(0,n.createElementVNode)("span",G,(0,n.toDisplayString)((0,n.unref)(d)),1),(0,n.createElementVNode)("i",{class:(0,n.normalizeClass)(["ml-auto cloudphonefont icon-menu-up",{visible:s.value}]),style:{color:"#787878"}},null,2)])])),default:(0,n.withCtx)((()=>[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(c.value,((e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",{class:(0,n.normalizeClass)(["ml-auto item px-4 d-flex fs-14 align-center justify-center pointer",e.text===(0,n.unref)(d)&&"active"]),key:t,onClick:()=>function(e){return Z(this,void 0,void 0,(function*(){l.value=e,p(e),s.value=!1}))}(e.value)},[e.text===(0,n.unref)(d)?((0,n.openBlock)(),(0,n.createElementBlock)("i",z)):(0,n.createCommentVNode)("",!0),(0,n.createElementVNode)("span",null,(0,n.toDisplayString)(e.text),1)],10,L)))),128))])),_:1},8,["show"]))}}),Q=(0,b.Z)(q,[["__scopeId","data-v-c1d3665e"]]);var Y=o(94110),K=o(56706),X=function(e,t,o,n){return new(o||(o=Promise))((function(a,l){function i(e){try{c(n.next(e))}catch(e){l(e)}}function r(e){try{c(n.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,r)}c((n=n.apply(e,t||[])).next())}))};const ee=e=>((0,n.pushScopeId)("data-v-6b8ff79e"),e=e(),(0,n.popScopeId)(),e),te={class:"flowContainer d-flex flex-column align-start justify-space-around pa-2 border-box"},oe={class:"item"},ne=ee((()=>(0,n.createElementVNode)("i",{class:"cloudphonefont icon-harddrive-outline mr-2 fs-12",style:{color:"#3296ff"}},null,-1))),ae={class:"mr-1"},le=ee((()=>(0,n.createElementVNode)("span",{style:{color:"#787878"}},"GB可用",-1))),ie={class:"item"},re=ee((()=>(0,n.createElementVNode)("i",{class:"cloudphonefont icon-harddrive-cloud-outline mr-2 fs-12",style:{color:"#3296ff"}},null,-1))),ce=ee((()=>(0,n.createElementVNode)("span",{style:{color:"#787878"}},"共",-1))),se={class:"mx-1"},de=ee((()=>(0,n.createElementVNode)("span",{style:{color:"#787878"}},"GB",-1))),ue={class:"item"},fe=ee((()=>(0,n.createElementVNode)("i",{class:"cloudphonefont icon-arrow-top mr-2 fs-12",style:{color:"#ff783c"}},null,-1))),pe={class:"ml-1",style:{color:"#787878"}},he={class:"item"},ve=ee((()=>(0,n.createElementVNode)("i",{class:"cloudphonefont icon-arrow-bottom mr-2 fs-12",style:{color:"#64c84b"}},null,-1))),me={class:"ml-1",style:{color:"#787878"}},ge=(0,n.defineComponent)({__name:"flow",setup(e){const t=i.nC.get(V.WY),o=(0,Y.u)(),{showPanel:l}=(0,a.Jk)(o),r=(0,K.Z)(),{usePanel:c}=(0,a.Jk)(r),s=(0,W.l)(),{configData:d,loadingConfig:f,currentDesktop:p}=(0,a.Jk)(s),h=(0,u.yj)(),v=(0,n.ref)("--"),m=(0,n.ref)(""),g=(0,n.ref)("--"),y=(0,n.ref)("");(0,n.ref)(!0);function k(e){return function(e){if(e<100)return"B";if(e/=1e3,e<1)return"KB";if(e>=1e3)return"MB";return"KB"}(e)+"/s"}function w(){return X(this,void 0,void 0,(function*(){if("phone_screen"!==h.name||!c.value)return;let e=yield t.getNetSpeed();v.value=b(e.download),g.value=b(e.upload),m.value=k(e.download),y.value=k(e.upload),w()}))}function b(e){return e<100?e:(e/=1e3)<1?e.toFixed(1):e>=1e3?(e/1e3).toFixed(1):Math.round(e)}return(0,n.onMounted)((()=>{s.getDesktopConfig(),w()})),(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",te,[(0,n.createElementVNode)("div",oe,[ne,(0,n.createElementVNode)("span",ae,(0,n.toDisplayString)((0,n.unref)(d).dataDiskGB),1),le]),(0,n.createElementVNode)("div",ie,[re,ce,(0,n.createElementVNode)("span",se,(0,n.toDisplayString)((0,n.unref)(d).totalDiskGB),1),de]),(0,n.createElementVNode)("div",ue,[fe,(0,n.createElementVNode)("span",null,(0,n.toDisplayString)(g.value),1),(0,n.createElementVNode)("span",pe,(0,n.toDisplayString)(y.value),1)]),(0,n.createElementVNode)("div",he,[ve,(0,n.createElementVNode)("span",null,(0,n.toDisplayString)(v.value),1),(0,n.createElementVNode)("span",me,(0,n.toDisplayString)(m.value),1)])]))}}),ye=(0,b.Z)(ge,[["__scopeId","data-v-6b8ff79e"]]),ke=e=>((0,n.pushScopeId)("data-v-2fd18a39"),e=e(),(0,n.popScopeId)(),e),we={class:"usageContainer"},be={class:"d-flex justify-space-around align-center fill-width fill-height py-2 px-1"},Ce={class:"cpu text-center"},Ve={key:0},Ne={class:"fs-16"},xe={key:1},Ee=ke((()=>(0,n.createElementVNode)("div",{class:"text"},"CPU",-1))),_e={class:"memory text-center"},Be={key:0},Re={class:"fs-16"},Se={key:1},De=ke((()=>(0,n.createElementVNode)("div",{class:"text"},"内存",-1))),Ie=(0,n.defineComponent)({__name:"usage",setup(e){const t=(0,W.l)(),{configData:o}=(0,a.Jk)(t);(0,n.ref)(0),(0,n.ref)(0);return(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",we,[(0,n.createElementVNode)("div",be,[(0,n.createElementVNode)("div",Ce,[(0,n.unref)(o).cpuCore?((0,n.openBlock)(),(0,n.createElementBlock)("div",Ve,[(0,n.createElementVNode)("span",Ne,(0,n.toDisplayString)((0,n.unref)(o).cpuCore),1),(0,n.createTextVNode)("核 ")])):((0,n.openBlock)(),(0,n.createElementBlock)("div",xe,"--")),Ee]),(0,n.createElementVNode)("div",_e,[(0,n.unref)(o).memoryGB?((0,n.openBlock)(),(0,n.createElementBlock)("div",Be,[(0,n.createElementVNode)("span",Re,(0,n.toDisplayString)((0,n.unref)(o).memoryGB),1),(0,n.createTextVNode)("GB ")])):((0,n.openBlock)(),(0,n.createElementBlock)("div",Se,"--")),De])])]))}}),Fe=(0,b.Z)(Ie,[["__scopeId","data-v-2fd18a39"]]);var Pe=o(47383),Me=(o(23582),o(61273)),Te=(o(94684),function(e,t,o,n){return new(o||(o=Promise))((function(a,l){function i(e){try{c(n.next(e))}catch(e){l(e)}}function r(e){try{c(n.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,r)}c((n=n.apply(e,t||[])).next())}))});const Oe={class:"px-4 py-8"},je=(0,n.defineComponent)({__name:"dialogEditNameV2",setup(e,{expose:t}){const o=i.nC.get(f.hD),l=(0,W.l)(),{configData:r}=(0,a.Jk)(l),c=Me.V.Component,s=(0,u.yj)(),d=(0,n.ref)(""),p=(0,n.ref)(!1),h=(0,n.ref)(!1);function v(e){return new Promise((t=>Te(this,void 0,void 0,(function*(){if("confirm"===e)if(d.value){p.value=!0;const e={desktopId:s.query.id,nickName:d.value};try{yield o.rename(e),p.value=!1,U.F.success("修改成功"),l.getDesktopConfig(),t(!0)}catch(e){p.value=!1,U.F.fail(e.message),t(!1)}finally{t(!0)}}else U.F.fail("请输入名称"),t(!1);else t(!0)}))))}return(0,n.watch)(h,(e=>{e&&(d.value=r.value.desktopName)})),t({visible:h}),(e,t)=>{const o=(0,n.resolveComponent)("el-input");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(c),{show:h.value,"onUpdate:show":t[1]||(t[1]=e=>h.value=e),title:"修改名称","show-cancel-button":"","close-on-click-overlay":!1,"before-close":v,teleport:"body"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Oe,[(0,n.createVNode)(o,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e),maxlength:"15","show-word-limit":"",disabled:p.value},null,8,["modelValue","disabled"])])])),_:1},8,["show"])}}}),We={class:"editNameContainer d-flex align-center pa-4"},He=(e=>((0,n.pushScopeId)("data-v-38984383"),e=e(),(0,n.popScopeId)(),e))((()=>(0,n.createElementVNode)("i",{class:"cloudphonefont icon-cellphone fs-36 white--text mr-2"},null,-1))),Ue={class:"white--text fs-16 mb-2"},$e={class:"fs-12 white--text"},Ze=(0,n.defineComponent)({__name:"editNameV2",setup(e){const t=(0,W.l)(),{configData:o}=(0,a.Jk)(t),l=(0,u.yj)(),i=(0,n.ref)(null);function r(){i.value&&(i.value.visible=!0)}return(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",We,[He,(0,n.createElementVNode)("div",null,[(0,n.createElementVNode)("div",Ue,[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(o).desktopName)+" ",1),(0,n.createElementVNode)("i",{class:"ml-2 cloudphonefont icon-square-edit-outline fs-18 pointer",onClick:r})]),(0,n.createElementVNode)("div",$e,(0,n.toDisplayString)((0,n.unref)(l).query.code),1)]),(0,n.createVNode)(je,{ref_key:"editRef",ref:i},null,512)]))}}),Le=(0,b.Z)(Ze,[["__scopeId","data-v-38984383"]]),ze=e=>((0,n.pushScopeId)("data-v-40931b5b"),e=e(),(0,n.popScopeId)(),e),Je={class:"configInfo pa-4"},Ae=ze((()=>(0,n.createElementVNode)("div",{class:"topic white--text fs-14 mt-4 mb-2"},"配置信息",-1))),Ge={class:"d-flex align-center justify-space-between"},qe={class:"cpu item white--text"},Qe=ze((()=>(0,n.createElementVNode)("i",{class:"iconfont icon-cpu fs-24"},null,-1))),Ye={class:"fs-12 white--text mt-2"},Ke={class:"memory item white--text"},Xe=ze((()=>(0,n.createElementVNode)("i",{class:"iconfont icon-processor fs-24"},null,-1))),et={class:"fs-12 white--text mt-2"},tt={class:"disk item white--text"},ot=ze((()=>(0,n.createElementVNode)("i",{class:"iconfont icon-system-disk fs-24"},null,-1))),nt={class:"fs-12 white--text mt-2"},at=(0,n.defineComponent)({__name:"configInfoV2",setup(e,{expose:t}){const o=(0,W.l)(),{configData:l}=(0,a.Jk)(o),i=(0,K.Z)(),{showConfig:r}=(0,a.Jk)(i);function c(){i.$patch({showConfig:!1,showPanel:!0})}return t({visible:(0,n.ref)(!1)}),(e,t)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Pe.G),{show:(0,n.unref)(r),"onUpdate:show":t[0]||(t[0]=e=>(0,n.isRef)(r)?r.value=e:null),onClose:c,"overlay-style":{background:"transparent"},round:"",class:"configInfoDialog"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Je,[(0,n.createVNode)(Le),Ae,(0,n.createElementVNode)("div",Ge,[(0,n.createElementVNode)("div",qe,[Qe,(0,n.createElementVNode)("p",Ye,(0,n.toDisplayString)((0,n.unref)(l).cpuCore||"--")+"核处理器",1)]),(0,n.createElementVNode)("div",Ke,[Xe,(0,n.createElementVNode)("p",et,(0,n.toDisplayString)((0,n.unref)(l).memoryGB||"--")+"G内存",1)]),(0,n.createElementVNode)("div",tt,[ot,(0,n.createElementVNode)("p",nt,(0,n.toDisplayString)((0,n.unref)(l).dataDiskGB||"--")+"GB存储",1)])])])])),_:1},8,["show"]))}}),lt=(0,b.Z)(at,[["__scopeId","data-v-40931b5b"]]);var it=o(31182);const rt={class:"systemSetting d-flex align-center flex-wrap justify-center"},ct=["onClick"],st={class:"iconContent mb-2 d-flex align-center justify-center"},dt={class:"topic fs-12"},ut=(0,n.defineComponent)({__name:"systemSetting",setup(e){const t=(0,W.l)(),o=(0,it.x)(),l=(0,K.Z)(),{showSetting:i}=(0,a.Jk)(l),r=((0,n.ref)(!1),(0,n.computed)((()=>[{text:"系统更新",id:"update",icon:"icon-arrow-up-bold",callback:d},{text:"系统重装",id:"restore",icon:"icon-restore",callback:s}])));function c(){l.$patch({showPanel:!0,showSetting:!1})}function s(){t.restore()}function d(){l.$reset(),U.F.loading("正在检查"),o.checkVersion(!0)}return(e,t)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Pe.G),{show:(0,n.unref)(i),"onUpdate:show":t[0]||(t[0]=e=>(0,n.isRef)(i)?i.value=e:null),onClose:c,"overlay-style":{background:"transparent"},round:"",class:"systemSettingDialog"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",rt,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)((0,n.unref)(r),(e=>((0,n.openBlock)(),(0,n.createElementBlock)("div",{class:(0,n.normalizeClass)(["toolItem d-flex align-center flex-column justify-center",{isDisabled:e.disabled}]),key:e.id,onClick:e.callback},[(0,n.createElementVNode)("div",st,[(0,n.createElementVNode)("i",{class:(0,n.normalizeClass)(["cloudphonefont fs-24",e.icon])},null,2)]),(0,n.createElementVNode)("p",dt,(0,n.toDisplayString)(e.text),1)],10,ct)))),128))])])),_:1},8,["show"]))}}),ft=(0,b.Z)(ut,[["__scopeId","data-v-7d1999b4"]]);var pt,ht=o(88538),vt=function(e,t,o,n){var a,l=arguments.length,i=l<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var r=e.length-1;r>=0;r--)(a=e[r])&&(i=(l<3?a(i):l>3?a(t,o,i):a(t,o))||i);return l>3&&i&&Object.defineProperty(t,o,i),i},mt=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},gt=function(e,t,o,n){return new(o||(o=Promise))((function(a,l){function i(e){try{c(n.next(e))}catch(e){l(e)}}function r(e){try{c(n.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,r)}c((n=n.apply(e,t||[])).next())}))};let yt=class{constructor(e){this.request=e}screenShotRecording(e){return gt(this,void 0,void 0,(function*(){return(yield this.request.api({method:"get",url:`api/desktop/client/ScreenshotRecording/${e.desktopId}/${e.type}`})).data}))}};yt=vt([(0,i.Xn)(),mt("design:paramtypes",["function"==typeof(pt=void 0!==ht.cf&&ht.cf)?pt:Object])],yt);var kt=function(e,t,o,n){return new(o||(o=Promise))((function(a,l){function i(e){try{c(n.next(e))}catch(e){l(e)}}function r(e){try{c(n.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,r)}c((n=n.apply(e,t||[])).next())}))};const wt=(0,a.Q_)("media",(()=>{const e=i.nC.get(f.hD),t=i.nC.get(yt);(0,u.yj)();return{screenshotRecording:function(o){return kt(this,void 0,void 0,(function*(){const n=e.connection;if(!n)return;const a={desktopId:n.desktop.uuid,type:o};try{yield t.screenShotRecording(a)}catch(e){U.F.fail(e.message)}}))}}}));var bt;!function(e){e[e.SCREEN_SHOT=1]="SCREEN_SHOT",e[e.RECORDING=2]="RECORDING",e[e.STOP_RECORDING=3]="STOP_RECORDING"}(bt||(bt={}));var Ct=o(41238),Vt=o(65050),Nt=o(94265),xt=o(91343),Et=o(9021),_t=o(58326),Bt=o(44487),Rt=(o(71142),o(18267),o(63135)),St=o(3873),Dt=o(82534),It=function(e,t,o,n){return new(o||(o=Promise))((function(a,l){function i(e){try{c(n.next(e))}catch(e){l(e)}}function r(e){try{c(n.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,r)}c((n=n.apply(e,t||[])).next())}))};const Ft={class:"reportHistoryContainer"},Pt=(0,n.defineComponent)({__name:"reportHistory",emits:["callback","handle"],setup(e,{emit:t}){const o=(0,K.Z)(),{showReportHistory:l}=(0,a.Jk)(o),i=(0,Rt.R)(),{historyList:r,loadingHistory:c,historyPage:s,refreshHistory:d,finishedHistory:u}=(0,a.Jk)(i);function f(){i.getReportHistory(s.value+1)}function p(){i.getReportHistory(1,!0)}return(0,n.onMounted)((()=>It(this,void 0,void 0,(function*(){yield i.initReportParams(),i.getReportHistory(1)})))),(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",Ft,[(0,n.createVNode)((0,n.unref)(_t.I),{modelValue:(0,n.unref)(d),"onUpdate:modelValue":t[1]||(t[1]=e=>(0,n.isRef)(d)?d.value=e:null),onRefresh:p,style:{"min-height":"calc(100% - 56px)"}},{default:(0,n.withCtx)((()=>[(0,n.createVNode)((0,n.unref)(Bt.a),{class:"historyContent",loading:e.loadingHisotry,"onUpdate:loading":t[0]||(t[0]=t=>e.loadingHisotry=t),finished:(0,n.unref)(u),"finished-text":"没有更多了",onLoad:f,"immediate-check":!1},{default:(0,n.withCtx)((()=>[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)((0,n.unref)(r),((e,t)=>((0,n.openBlock)(),(0,n.createBlock)(St.Z,{key:t,item:e},null,8,["item"])))),128))])),_:1},8,["loading","finished"])])),_:1},8,["modelValue"]),(0,n.createVNode)(Dt.Z)]))}}),Mt=(0,b.Z)(Pt,[["__scopeId","data-v-7db9d566"]]);var Tt=o(14957),Ot=o(52704),jt=(o(52719),o(3147),o(92518)),Wt=function(e,t,o,n){return new(o||(o=Promise))((function(a,l){function i(e){try{c(n.next(e))}catch(e){l(e)}}function r(e){try{c(n.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,r)}c((n=n.apply(e,t||[])).next())}))};const Ht={class:"reportContainer"},Ut=(e=>((0,n.pushScopeId)("data-v-4fadc3ce"),e=e(),(0,n.popScopeId)(),e))((()=>(0,n.createElementVNode)("div",{class:"my-4",style:{"border-top":"1px solid #f5f7fa"}},null,-1))),$t={style:{background:"#f5f7fa"},class:"pa-4"},Zt=(0,n.defineComponent)({__name:"reportForm",setup(e){const t=(0,u.yj)(),o=(0,Et.C)(),l=((0,W.l)(),(0,Rt.R)()),{authData:i,logged:r}=(0,a.Jk)(o),{reportType:c,loadingDesktops:s,reportDesktop:d,reportDesktops:f,reportDesktopText:p,reporting:h,reportContact:v,reportPhone:m,reportEmail:g,reportTypeText:y,reportFiles:k,reportTypes:w,reportDesc:b,reportUserName:C}=(0,a.Jk)(l),V=(0,n.ref)(!1),N=(0,n.ref)(!1),x=(0,n.ref)(null),E=(0,n.computed)((()=>"phone_screen"===t.name)),_=(0,n.computed)((()=>(0,S.cloneDeep)(f.value).map((e=>(d.value&&e.id===d.value.id&&(e.className="active",e.color="#2896FF"),e))))),B=(0,n.computed)((()=>(0,S.cloneDeep)(w.value).map((e=>(c.value&&e.id===c.value.id&&(e.className="active",e.color="#2896FF"),e))))),R=(0,n.ref)({reportUserName:"",reportTypeText:"",reportDesc:"",reportContact:"",reportPhone:"",reportEmail:""});function D(){V.value=!0}function I(e){l.updateReportType(e),V.value=!1}function F(){N.value=!0}function P(e){l.updateReportDesktop(e),N.value=!1}function M(){return Wt(this,void 0,void 0,(function*(){l.submitReport()}))}return(0,n.watch)(r,(e=>{e&&(l.getReportDesktops(),l.initReporter())})),(0,n.onMounted)((()=>{l.getReportDesktops(),l.initReporter()})),(e,t)=>{const o=(0,n.resolveComponent)("el-input"),a=(0,n.resolveComponent)("el-form-item"),i=(0,n.resolveComponent)("el-form"),c=(0,n.resolveComponent)("el-button");return(0,n.openBlock)(),(0,n.createElementBlock)("div",Ht,[(0,n.createVNode)(i,{class:"pa-4 white fill-width","show-message":!1,"label-width":"80px",model:R.value,size:"large"},{default:(0,n.withCtx)((()=>[(0,n.unref)(r)?(0,n.createCommentVNode)("",!0):((0,n.openBlock)(),(0,n.createBlock)(a,{key:0,class:"white",label:"用户名","show-required":"",prop:"reportUserName"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(o,{modelValue:(0,n.unref)(C),"onUpdate:modelValue":t[0]||(t[0]=e=>(0,n.isRef)(C)?C.value=e:null),placeholder:"请输入您的用户名",clearable:"",onChange:(0,n.unref)(l).updateReportUserName,disabled:e.resporting},null,8,["modelValue","onChange","disabled"])])),_:1})),(0,n.createVNode)(a,{class:"white",label:"故障类型","show-required":"",prop:"reportTypeText"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(o,{placeholder:"请选择故障类型",onFocus:D,modelValue:(0,n.unref)(y),"onUpdate:modelValue":t[1]||(t[1]=e=>(0,n.isRef)(y)?y.value=e:null),readonly:"",disabled:e.resporting},null,8,["modelValue","disabled"]),(0,n.createVNode)((0,n.unref)(Tt.V),{show:V.value,"onUpdate:show":t[2]||(t[2]=e=>V.value=e),actions:(0,n.unref)(B),"cancel-text":"取消",description:"请选择故障类型",onSelect:I},null,8,["show","actions"])])),_:1}),(0,n.unref)(r)?((0,n.openBlock)(),(0,n.createBlock)(a,{key:1,class:"white",label:"选择桌面"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(o,{placeholder:"请选择故障桌面",onFocus:F,modelValue:(0,n.unref)(p),"onUpdate:modelValue":t[3]||(t[3]=e=>(0,n.isRef)(p)?p.value=e:null),readonly:"",disabled:e.resporting||(0,n.unref)(E)},null,8,["modelValue","disabled"]),(0,n.createVNode)((0,n.unref)(Tt.V),{show:N.value,"onUpdate:show":t[4]||(t[4]=e=>N.value=e),actions:(0,n.unref)(_),"cancel-text":"取消",description:"请选择故障桌面",onSelect:P},null,8,["show","actions"])])),_:1})):(0,n.createCommentVNode)("",!0),(0,n.createVNode)(a,{class:"white",label:"故障描述","show-required":"",prop:"reportDesc"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(o,{modelValue:(0,n.unref)(b),"onUpdate:modelValue":t[5]||(t[5]=e=>(0,n.isRef)(b)?b.value=e:null),type:"textarea",rows:3,placeholder:"请输入故障的情况",maxlength:"2000","show-word-limit":"",onChange:(0,n.unref)(l).updateReportDesc,disabled:e.resporting},null,8,["modelValue","onChange","disabled"])])),_:1}),(0,n.createVNode)(a,{class:"white",label:"上传图片"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(jt.Z,{ref_key:"uploader",ref:x},null,512)])),_:1}),Ut,(0,n.createVNode)(a,{class:"white",label:"联系人","show-required":"",prop:"reportContact"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(o,{modelValue:(0,n.unref)(v),"onUpdate:modelValue":t[6]||(t[6]=e=>(0,n.isRef)(v)?v.value=e:null),placeholder:"请输入您的称呼",onChange:(0,n.unref)(l).updateReportContact,disabled:e.resporting},null,8,["modelValue","onChange","disabled"])])),_:1}),(0,n.createVNode)(a,{class:"white",label:"电话","show-required":"",prop:"reportPhone"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(o,{modelValue:(0,n.unref)(m),"onUpdate:modelValue":t[7]||(t[7]=e=>(0,n.isRef)(m)?m.value=e:null),placeholder:"请输入电话号码",onChange:(0,n.unref)(l).updateReportPhone,disabled:e.resporting},null,8,["modelValue","onChange","disabled"])])),_:1}),(0,n.createVNode)(a,{class:"white",label:"邮箱","show-required":"",prop:"reportEmail"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(o,{modelValue:(0,n.unref)(g),"onUpdate:modelValue":t[8]||(t[8]=e=>(0,n.isRef)(g)?g.value=e:null),placeholder:"请输入邮箱地址",onChange:(0,n.unref)(l).updateReportEmail,disabled:e.resporting},null,8,["modelValue","onChange","disabled"])])),_:1})])),_:1},8,["model"]),(0,n.createVNode)((0,n.unref)(Ot.L),{position:"bottom"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",$t,[(0,n.createVNode)(c,{block:"",type:"primary",onClick:M,style:{"box-sizing":"border-box"},size:"large"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)("提交")])),_:1})])])),_:1})])}}}),Lt=(0,b.Z)(Zt,[["__scopeId","data-v-4fadc3ce"]]);var zt=o(69930),Jt=o(47150),At=function(e,t,o,n){return new(o||(o=Promise))((function(a,l){function i(e){try{c(n.next(e))}catch(e){l(e)}}function r(e){try{c(n.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,r)}c((n=n.apply(e,t||[])).next())}))};const Gt=(0,n.defineComponent)({__name:"reportFeedback",setup(e){const t=(0,Rt.R)(),{feedbackList:o,feedbackPage:l,loadingFeedback:i,scrollBottom:r,finishedFeedback:c}=(0,a.Jk)(t),s=(0,n.ref)(null),d=(0,K.Z)(),{feedbackId:u}=(0,a.Jk)(d);function f(){t.getReportFeedback(l.value+1)}function p(){s.value&&(s.value.scrollTop=s.value.scrollHeight-56-48,t.updateScrollBottom(!1))}return(0,n.watch)(r,(e=>{e&&p()})),(0,n.onMounted)((()=>At(this,void 0,void 0,(function*(){yield t.getReportFeedback(1),(0,n.nextTick)((()=>{p()}))})))),(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",{class:"reportFeedback",ref_key:"feedback",ref:s},[(0,n.createVNode)((0,n.unref)(_t.I),{modelValue:(0,n.unref)(i),"onUpdate:modelValue":t[0]||(t[0]=e=>(0,n.isRef)(i)?i.value=e:null),onRefresh:f,disabled:(0,n.unref)(c),style:{"min-height":"calc(100% - 56px)"}},{default:(0,n.withCtx)((()=>[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)((0,n.unref)(o),((e,t)=>((0,n.openBlock)(),(0,n.createBlock)(zt.Z,{key:t,item:e},null,8,["item"])))),128))])),_:1},8,["modelValue","disabled"]),(0,n.createVNode)(Jt.Z)],512))}}),qt=(0,b.Z)(Gt,[["__scopeId","data-v-a326b236"]]),Qt={class:"title"},Yt=["onClick"],Kt={key:0,class:"px-4 pt-4 pb-2 fs-12 grey--text text--light-2"},Xt={class:"d-flex align-center white pa-4"},eo={class:"ml-4 fs-14"},to=(0,n.defineComponent)({__name:"report",setup(e){(0,u.tv)();const t=(0,Et.C)(),{logged:o}=(0,a.Jk)(t),l=(0,K.Z)(),{showReport:i,showReportHistory:r,showReportFeedback:c,showReportForm:s,reportTitle:d,reportCloseIcon:f,reportCloseIconPosition:p}=(0,a.Jk)(l),h=(0,n.ref)(!0),v=(0,n.computed)((()=>[{name:"报障历史",id:"history",icon:Ct.Z,color:"#3296FF",isValid:o.value},{name:"我要报障",tips:"如需报障，请选择您的报障方式",id:"report",icon:Vt.Z,color:"#3296FF",isValid:!0},{name:"拨打客服热线",id:"phone",icon:Nt.Z,color:"#3296FF",isValid:!0}]));function m(){l.$patch({showPanel:!0,showReport:!1})}function g(){return r.value?(l.$patch({reportTitle:"报障",reportCloseIcon:"cross",reportCloseIconPosition:"top-right",showReportHistory:!1}),!1):s.value?(l.$patch({reportTitle:"报障",reportCloseIcon:"cross",reportCloseIconPosition:"top-right",showReportForm:!1}),!1):!c.value||(l.$patch({reportTitle:"报障历史",showReportFeedback:!1,showReportHistory:!0}),!1)}return(e,t)=>{const o=(0,n.resolveComponent)("el-icon");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Pe.G),{show:(0,n.unref)(i),"onUpdate:show":t[0]||(t[0]=e=>(0,n.isRef)(i)?i.value=e:null),class:"reportMainContainer",style:{height:"100%",width:"100%"},closeable:h.value,onClose:m,"before-close":g,"close-icon":(0,n.unref)(f),"close-icon-position":(0,n.unref)(p)},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Qt,(0,n.toDisplayString)((0,n.unref)(d)),1),(0,n.withDirectives)((0,n.createElementVNode)("div",null,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)((0,n.unref)(v),(e=>(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createElementBlock)("div",{class:"item",key:e.id,onClick:()=>function(e){switch(e){case"history":l.$patch({showReportHistory:!0,reportTitle:"报障历史",reportCloseIcon:"arrow-left",reportCloseIconPosition:"top-left"});break;case"report":l.$patch({showReportForm:!0,reportTitle:"报障受理",reportCloseIcon:"arrow-left",reportCloseIconPosition:"top-left"});break;case"phone":window.location.href="tel:4008109889"}}(e.id)},[e.tips?((0,n.openBlock)(),(0,n.createElementBlock)("div",Kt,(0,n.toDisplayString)(e.tips),1)):(0,n.createCommentVNode)("",!0),(0,n.createElementVNode)("div",Xt,[(0,n.createVNode)(o,{color:e.color,size:20},{default:(0,n.withCtx)((()=>[((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)(e.icon)))])),_:2},1032,["color"]),(0,n.createElementVNode)("div",eo,(0,n.toDisplayString)(e.name),1),(0,n.createVNode)(o,{class:"ml-auto"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)((0,n.unref)(xt.Z))])),_:1})])],8,Yt)),[[n.vShow,e.isValid]]))),128))],512),[[n.vShow,!(0,n.unref)(r)&&!(0,n.unref)(s)&&!(0,n.unref)(c)]]),(0,n.unref)(r)?((0,n.openBlock)(),(0,n.createBlock)(Mt,{key:0})):(0,n.createCommentVNode)("",!0),(0,n.unref)(s)?((0,n.openBlock)(),(0,n.createBlock)(Lt,{key:1})):(0,n.createCommentVNode)("",!0),(0,n.unref)(c)?((0,n.openBlock)(),(0,n.createBlock)(qt,{key:2})):(0,n.createCommentVNode)("",!0)])),_:1},8,["show","closeable","close-icon","close-icon-position"])}}}),oo=(0,b.Z)(to,[["__scopeId","data-v-e39184b6"]]);var no=function(e,t,o,n){return new(o||(o=Promise))((function(a,l){function i(e){try{c(n.next(e))}catch(e){l(e)}}function r(e){try{c(n.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,r)}c((n=n.apply(e,t||[])).next())}))};const ao={class:"ballPanel py-4 themeDark"},lo={class:"top d-flex align-center justify-center pb-2"},io={class:"left pl-4 pr-2"},ro={class:"right pl-2 pr-4 d-flex flex-column justify-space-between",style:{height:"112px"}},co={class:"tool d-flex align-center flex-wrap justify-center"},so=["onClick"],uo={class:"iconContent mb-2 d-flex align-center justify-center"},fo={class:"topic fs-12"},po={class:"icon-wrap mt-4"},ho=(0,n.defineComponent)({__name:"ballPanelV2",emits:["callback"],setup(e,{emit:t}){const o=i.nC.get(V.WY),r=l.N.get(_.C),c=D(),{isVertical:d}=(0,a.Jk)(c),f=(0,s.n)(),p=(0,W.l)(),h=((0,Y.u)(),wt()),v=(0,K.Z)(),{showPanel:m}=(0,a.Jk)(v),g=((0,u.tv)(),(0,u.yj)()),y=(0,n.ref)(!0),k=(0,n.ref)(!0),w=(0,n.ref)(),b=(0,n.ref)(),C=(0,n.ref)(),N=(0,n.computed)((()=>[{text:"屏幕旋转",id:"rotate",icon:d.value?"icon-phone-rotate-landscape":"icon-phone-rotate-portrait",callback:B},{text:"截图",id:"shortcut",icon:"icon-crop",callback:S},{text:"录屏",id:"record",icon:"icon-checkbox-intermediate-circle",callback:I},{text:"内存清理",id:"clear",icon:"icon-content-save-outline",callback:F,disabled:!0},{text:"配置信息",id:"config",icon:"icon-cloud-phone",callback:R},{text:"系统设置",id:"setting",icon:"icon-setting-outline",callback:T},{text:"报障",id:"report",icon:"icon-alarm-light-outline",callback:E},{text:"退出",id:"exit",icon:"icon-exit",callback:M},{text:"重启",id:"reboot",icon:"icon-reboot",callback:x},{text:"关机",id:"off",icon:"icon-power",callback:P}]));function x(){v.$reset(),p.reboot(!0)}function E(){v.$patch({showReport:!0,showPanel:!1})}function B(){return no(this,void 0,void 0,(function*(){yield c.toggleVertical();let e=window.innerWidth,t=window.innerHeight;r.resetWindowByTransform({styleWidth:e,styleHeight:t})}))}function R(){y.value=!1,v.$patch({showConfig:!0,showPanel:!1})}function S(){return no(this,void 0,void 0,(function*(){h.screenshotRecording(bt.SCREEN_SHOT),v.$patch({showBall:!0,usePanel:!1})}))}function I(){h.screenshotRecording(bt.RECORDING),v.$patch({showBall:!0,usePanel:!1})}function F(){}function P(){v.$reset(),p.powerOff()}function M(){v.$reset(),f.exit(String(g.query.id))}function T(){y.value=!1,v.$patch({showPanel:!1,showSetting:!0})}function O(){o.input({code:V.F3.RETURN,value:V.gt.UP})}function j(){o.input({code:V.F3.RETURN,value:V.gt.DOWN})}function H(){o.input({code:V.F3.HOME,value:V.gt.UP})}function U(){o.input({code:V.F3.HOME,value:V.gt.DOWN})}function $(){o.input({code:V.F3.MENU,value:V.gt.UP})}function Z(){o.input({code:V.F3.MENU,value:V.gt.DOWN})}return(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.withDirectives)((0,n.createElementVNode)("div",ao,[(0,n.createElementVNode)("div",lo,[(0,n.createElementVNode)("div",io,[(0,n.createVNode)(ye)]),(0,n.createElementVNode)("div",ro,[(0,n.createVNode)(Q),(0,n.createVNode)(Fe)])]),(0,n.createElementVNode)("div",co,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)((0,n.unref)(N),(e=>((0,n.openBlock)(),(0,n.createElementBlock)("div",{class:(0,n.normalizeClass)(["toolItem d-flex align-center flex-column justify-center",{isDisabled:e.disabled}]),key:e.id,onClick:e.callback},[(0,n.createElementVNode)("div",uo,[(0,n.createElementVNode)("i",{class:(0,n.normalizeClass)(["cloudphonefont fs-24",e.icon])},null,2)]),(0,n.createElementVNode)("p",fo,(0,n.toDisplayString)(e.text),1)],10,so)))),128))]),(0,n.withDirectives)((0,n.createElementVNode)("div",po,[(0,n.createElementVNode)("i",{class:"cloudphonefont icon-triangle-outline fs-24 pointer",onMousedown:j,onMouseup:O},null,32),(0,n.createElementVNode)("i",{class:"cloudphonefont icon-circle-outline fs-24 pointer",onMousedown:U,onMouseup:H},null,32),(0,n.createElementVNode)("i",{class:"cloudphonefont icon-square-rounded-outline fs-24 pointer",onMousedown:Z,onMouseup:$},null,32)],512),[[n.vShow,k.value]])],512),[[n.vShow,(0,n.unref)(m)]]),(0,n.createVNode)(lt,{ref_key:"configRef",ref:w},null,512),(0,n.createVNode)(ft,{ref_key:"systemSettingRef",ref:b},null,512),(0,n.createVNode)(oo,{ref_key:"reportRef",ref:C},null,512)],64))}}),vo=(0,b.Z)(ho,[["__scopeId","data-v-0427186e"]]),mo=["onTouchstart","onTouchmove","onTouchend"],go=(e=>((0,n.pushScopeId)("data-v-5ced3d00"),e=e(),(0,n.popScopeId)(),e))((()=>(0,n.createElementVNode)("div",{class:"ring"},null,-1))),yo=(0,n.defineComponent)({__name:"ball",props:{text:{type:String,default:"ball"},itemWidth:{type:Number,default:40},itemHeight:{type:Number,default:40}},setup(e){const t=e,o=i.nC.get(V.WY),r=((0,Y.u)(),(0,K.Z)()),{usePanel:c,showBall:s}=(0,a.Jk)(r),d=(0,Rt.R)(),u=(0,n.ref)(null),f=(0,n.ref)(0),p=(0,n.ref)(0),h=((0,n.ref)(!0),(0,n.ref)("good")),v=(0,n.ref)(!1),m=(0,n.ref)(1),g=(0,n.ref)(!0),y=l.N.get(_.C),k=D(),{realRatio:w,phoneSize:b,isVertical:C}=(0,a.Jk)(k),N=(0,n.ref)({width:window.innerWidth,height:window.innerHeight}),x=(0,n.ref)({width:window.innerWidth,height:window.innerHeight});(0,n.computed)((()=>({width:window.innerWidth,height:window.innerHeight})));let B,R=window.innerWidth,S=window.innerHeight,I=!1;function F(){r.$reset()}function P(){g.value&&(r.$patch({showBall:!1,usePanel:!0}),d.$reset())}function M(){I=!0,u.value.style.transition="none"}function T(e){const o=e.targetTouches[0].clientX,n=e.targetTouches[0].clientY,a=o<=R&&o>=0&&n<=S&&n>=0;I&&1===e.targetTouches.length&&a&&(f.value=o-t.itemWidth/2,p.value=n-t.itemHeight/2),g.value=!1}function O(){let e=0,o=0;C.value?(e=N.value.width,o=N.value.height):(e=N.value.height,o=N.value.width),f.value<x.value.width/2+e/2-t.itemWidth/2?f.value=x.value.width/2+8:f.value=x.value.width/2+e-t.itemWidth-8,p.value<x.value.height/2&&(p.value=x.value.height/2+8),p.value>x.value.height/2+o-t.itemHeight&&(p.value=x.value.height/2+o-t.itemHeight-8),u.value.style.transition="all .3s",setTimeout((()=>{g.value=!0}),0)}return(0,n.onMounted)((()=>{f.value=R-t.itemWidth-30,p.value=S/2-t.itemHeight/2,H.$x.on(H.eM.CLOSE_BALL_PANEL,(()=>{F()})),o.onNetworkState.on((e=>{const{delay:t}=e;v.value||(v.value=!0),m.value=t>1?t:1,h.value=t<=50?"good":t<=100?"normal":"poor"})),B=y.onUpdateDisplaySize.on((e=>{let{styleHeight:t,styleWidth:o}=e,n=o,a=t;C.value||(n=t,a=o),(0,E.Kl)(b.value.width,b.value.height,C.value)?(N.value.width=n,N.value.height=n/w.value):(N.value.width=a*w.value,N.value.height=a),C.value?(window.innerWidth>N.value.width?x.value.width=window.innerWidth-N.value.width:x.value.width=0,window.innerHeight>N.value.height?x.value.height=window.innerHeight-N.value.height:x.value.height=0):(window.innerHeight>N.value.width?x.value.height=window.innerHeight-N.value.width:x.value.height=0,window.innerWidth>N.value.height?x.value.width=window.innerWidth-N.value.height:x.value.width=0),O()}))})),(0,n.onUnmounted)((()=>{B&&B.dispose()})),(0,H.pv)({"close-ball":F}),(e,o)=>((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.unref)(s)?((0,n.openBlock)(),(0,n.createElementBlock)("div",{key:0,class:(0,n.normalizeClass)(["ballContainer",["breathing_lamp",h.value]]),ref_key:"breathingLamp",ref:u,onClick:P,onTouchstart:(0,n.withModifiers)(M,["stop"]),onTouchmove:(0,n.withModifiers)(T,["prevent","stop"]),onTouchend:(0,n.withModifiers)(O,["stop"]),style:(0,n.normalizeStyle)({left:f.value+"px",top:p.value+"px",width:t.itemWidth+"px",height:t.itemHeight+"px"})},[(0,n.createTextVNode)((0,n.toDisplayString)(v.value?m.value+"ms":"...")+" ",1),go],46,mo)):(0,n.createCommentVNode)("",!0),(0,n.unref)(c)?((0,n.openBlock)(),(0,n.createBlock)(vo,{key:1})):(0,n.createCommentVNode)("",!0),(0,n.unref)(c)?((0,n.openBlock)(),(0,n.createElementBlock)("div",{key:2,class:"mask",onClick:F})):(0,n.createCommentVNode)("",!0)],64))}}),ko=(0,b.Z)(yo,[["__scopeId","data-v-5ced3d00"]]);var wo=function(e,t,o,n){return new(o||(o=Promise))((function(a,l){function i(e){try{c(n.next(e))}catch(e){l(e)}}function r(e){try{c(n.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,r)}c((n=n.apply(e,t||[])).next())}))};const bo={class:"grey fill-height fill-width d-flex align-center justify-center"},Co=(0,n.defineComponent)({__name:"PhoneScreen",setup(e){i.nC.get(f.hD),i.nC.get(r.Xn);const t=l.N.get(_.C),o=i.nC.get(V.WY),c=(0,s.n)(),{connected:d,connectState:p}=(0,a.Jk)(c),h=((0,n.ref)(window.innerWidth),(0,n.ref)(window.innerHeight),(0,u.yj)(),D()),{isVertical:v}=(0,a.Jk)(h);function m(){o.onAgentData.on((e=>{if(e.type===V.je.ROTATE&&e.data.content){!function(e){wo(this,void 0,void 0,(function*(){yield h.updateVertical(e);let o=window.innerWidth,n=window.innerHeight;t.resetWindowByTransform({styleWidth:o,styleHeight:n})}))}(0==JSON.parse(e.data.content).oritation)}}))}return(0,n.onMounted)((()=>{m(),l.N.init(),l.N.connecting(),o.whenAgentConnected().then((()=>{l.N.agentConnected()}))})),(0,n.onUnmounted)((()=>{c.$reset(),h.$reset(),l.N.exit()})),(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",bo,[(0,n.withDirectives)((0,n.createVNode)(C,null,null,512),[[n.vShow,!(0,n.unref)(d)]]),(0,n.createVNode)(j,{class:(0,n.normalizeClass)(!(0,n.unref)(v)&&"horizontal")},null,8,["class"]),(0,n.createVNode)(T,{class:(0,n.normalizeClass)(!(0,n.unref)(v)&&"horizontal")},null,8,["class"]),(0,n.createVNode)(ko)]))}}),Vo=(0,b.Z)(Co,[["__scopeId","data-v-5bcab71d"]])},69930:(e,t,o)=>{o.d(t,{Z:()=>w});var n=o(89810),a=o(65431),l=o(86015),i=(o(71755),o(8770)),r=o(55516),c=o(35393),s=o(63135);const d={key:0,class:"iconfont icon-user"},u={class:"info"},f={class:"who mb-2"},p={class:"desc mb-2 d-flex align-center"},h={key:0,class:"text"},v={style:{direction:"ltr"}},m={class:"image-slot"},g={key:0,class:"replying mr-2"},y={class:"time my-4"},k=(0,n.defineComponent)({__name:"feedbackItem",props:{item:null},setup(e){const t=e,o=(0,s.R)(),{feedbackList:k,feedbackImages:w}=(0,a.Jk)(o),b=(0,n.computed)((()=>t.item)),C=(0,n.computed)((()=>b.value.feedbackAttach?b.value.feedbackAttach.match("data:image")?[b.value.feedbackAttach]:b.value.feedbackAttach.split(","):[])),V=(0,n.inject)("$filter"),N=(0,n.computed)((()=>2===b.value.feedbackSource)),x=(0,n.computed)((()=>2===b.value.feedbackSource?"我":0===b.value.feedbackSource?"客服":3===b.value.feedbackSource?"运维":"-"));function E(){b.value.params.files?o.submitFeedbackFile(b.value):o.retryFeedbackMsg(b.value)}return(e,t)=>{const o=(0,n.resolveComponent)("el-icon"),a=(0,n.resolveComponent)("el-image");return(0,n.openBlock)(),(0,n.createElementBlock)("div",{class:(0,n.normalizeClass)(["feedbackItem pa-2",(0,n.unref)(N)&&"is-reverse"])},[(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)(["avatar",(0,n.unref)(N)&&"primary"])},[(0,n.unref)(N)?((0,n.openBlock)(),(0,n.createElementBlock)("i",d)):(0,n.createCommentVNode)("",!0)],2),(0,n.createElementVNode)("div",u,[(0,n.createElementVNode)("div",f,(0,n.toDisplayString)((0,n.unref)(x)),1),(0,n.createElementVNode)("div",p,[(0,n.createElementVNode)("div",null,[(0,n.unref)(b).feedbackMsg?((0,n.openBlock)(),(0,n.createElementBlock)("div",h,[(0,n.createElementVNode)("span",v,(0,n.toDisplayString)((0,n.unref)(b).feedbackMsg),1)])):(0,n.createCommentVNode)("",!0),((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)((0,n.unref)(C),((e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",{key:t,class:"imageItem"},[e?((0,n.openBlock)(),(0,n.createBlock)(a,{key:0,class:"img",src:e,fix:"cover",onClick:()=>function(e){const t=w.value.findIndex((t=>t===e));(0,l.e)({images:w.value,startPosition:t})}(e)},{error:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",m,[(0,n.createVNode)(o,null,{default:(0,n.withCtx)((()=>[(0,n.createVNode)((0,n.unref)(i.Z))])),_:1})])])),_:2},1032,["src","onClick"])):(0,n.createCommentVNode)("",!0)])))),128))]),(0,n.unref)(N)&&(0,n.unref)(b).replying?((0,n.openBlock)(),(0,n.createElementBlock)("div",g,[(0,n.createVNode)(o,{class:"is-loading",size:"16"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)((0,n.unref)(r.Z))])),_:1})])):(0,n.createCommentVNode)("",!0),(0,n.unref)(N)&&(0,n.unref)(b).retry?((0,n.openBlock)(),(0,n.createElementBlock)("div",{key:1,class:"retry mr-2",onClick:E},[(0,n.createVNode)(o,{color:"red",size:"16"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)((0,n.unref)(c.Z))])),_:1})])):(0,n.createCommentVNode)("",!0)]),(0,n.createElementVNode)("div",y,(0,n.toDisplayString)((0,n.unref)(V).formatTime((0,n.unref)(b).createdTime)),1)])],2)}}});const w=(0,o(57775).Z)(k,[["__scopeId","data-v-584a0f40"]])},47150:(e,t,o)=>{o.d(t,{Z:()=>f});var n=o(89810),a=o(64566),l=o(52704),i=(o(3147),o(15807),o(50786)),r=o(63135),c=o(65431);const s={class:"feedbackReplyContainer d-flex align-center pa-2 white"},d=["accept"],u=(0,n.defineComponent)({__name:"feedbackReply",setup(e){const t=(0,r.R)(),{feedbackReplyContent:o,replying:u}=(0,c.Jk)(t),f=(0,n.ref)(),p=(0,n.ref)("image/png, image/jpg, image/jpeg");function h(){t.submitFeedbackMsg()}return(e,r)=>{const c=(0,n.resolveComponent)("el-input"),v=(0,n.resolveComponent)("el-button"),m=(0,n.resolveComponent)("el-icon");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(l.L),{position:"bottom",offset:"0"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",s,[(0,n.createVNode)(c,{modelValue:(0,n.unref)(o),"onUpdate:modelValue":r[0]||(r[0]=e=>(0,n.isRef)(o)?o.value=e:null),class:"fill-width",onKeyup:(0,n.withKeys)(h,["enter","native"]),onInput:(0,n.unref)(t).updateFeedbackReplyContent,"show-word-limit":"",maxlength:"200"},null,8,["modelValue","onKeyup","onInput"]),(0,n.createVNode)(v,{type:"primary",plain:"",class:"ml-2",disabled:(0,n.unref)(u)|!(0,n.unref)(o),onClick:h},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)("发送")])),_:1},8,["disabled"]),(0,n.createVNode)(m,{class:"ml-2 pointer",size:24,onClick:r[1]||(r[1]=e=>(0,n.unref)(f).click())},{default:(0,n.withCtx)((()=>[(0,n.createVNode)((0,n.unref)(i.Z))])),_:1}),(0,n.createElementVNode)("input",{type:"file",ref_key:"file",ref:f,name:"files",onChange:r[2]||(r[2]=e=>function(e){if(!e)return;const o=e.size/1024/1024<5;if("image/jpeg"!==e.type&&"image/png"!==e.type&&"image/jpg"!==e.type)return a.F.fail("只能上传 jpg/png 格式的图片"),!1;if(!o)return a.F.fail("上传图片大小不能超过 5MB!"),!1;let n="",l=new FileReader;l.readAsDataURL(e),l.onload=()=>{n=l.result;const o={params:{files:e},createdTime:Date.now(),feedbackSource:2,feedbackAttach:l.result,feedbackMsg:"",replying:!0,retry:!1};t.submitFeedbackFile(o)}}(e.target.files[0])),accept:p.value,id:"files",style:{display:"none"}},null,40,d)])])),_:1})}}});const f=(0,o(57775).Z)(u,[["__scopeId","data-v-c734c25c"]])},92518:(e,t,o)=>{o.d(t,{Z:()=>p});var n=o(89810),a=o(64566),l=o(84117),i=(o(84298),o(71755),o(91459),o(15807),o(54199),o(39094),o(23582),o(69942),o(48402)),r=o(6522),c=o(6298),s=o(41461),d=o.n(s),u=o(63135),f=o(65431);const p=(0,n.defineComponent)({__name:"uploader",setup(e,{expose:t}){const o=i.nC.get(r.Xb),s=(i.nC.get(c.g),(0,n.ref)("image/jpg,image/png,image/jpeg")),p=(0,u.R)(),{reportData:h,reportHeaders:v}=(0,f.Jk)(p),m=(0,n.ref)([]),g=(0,n.computed)((()=>`${o.getAPIHost()}/api/v2/client/uploadWsheetFile`));function y(e,t){return p.deleteReportFiles(t.index),!0}function k(e,t){let o=new FormData;if(h.value){const e=h.value;Object.keys(h.value).forEach((t=>{o.append(t,e[t])}))}e.length?e.map(((e,t)=>{e.status="uploading",e.message="上传中...",o.append("files",e.file),d().post(g.value,o,{headers:Object.assign({"Content-Type":"multipart/form-data"},(0,n.toRaw)(v.value))}).then((o=>{o.data.code?(a.F.fail(o.data.msg),e.status="failed",e.message="上传失败"):(e.status="done",p.addReportFiles({index:t,value:o.data.data}))})).catch((t=>{e.status="failed",e.message="上传失败",a.F.fail(t.message)}))})):(e.status="uploading",e.message="上传中...",o.append("files",e.file),d().post(g.value,o,{headers:Object.assign({"Content-Type":"multipart/form-data"},(0,n.toRaw)(v.value))}).then((t=>{t.data.code?(a.F.fail(t.data.msg),e.status="failed",e.message="上传失败"):(e.status="done",p.addReportFiles({value:t.data.data}))})).catch((t=>{e.status="failed",e.message="上传失败",a.F.fail(t.message)})))}function w(e){return!0}function b(){(0,a.F)("上传图片大小不能超过 5MB!")}return(0,n.onMounted)((()=>{p.initReportParams()})),t({uploadFiles:m}),(e,t)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(l.Q),{modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=e=>m.value=e),"max-count":3,multiple:"","after-read":k,"before-read":w,accept:s.value,"max-size":5242880,name:"files",onOversize:b,"before-delete":y},null,8,["modelValue","accept"]))}})}}]);