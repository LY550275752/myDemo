"use strict";(self.webpackChunkclink_web=self.webpackChunkclink_web||[]).push([[9961],{72900:(e,t,n)=>{function i(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function o(e){let t;if("object"!=typeof e)t=e;else if("null"===i(e)||"undefined"===i(e))t=e;else if("array"===i(e)){let n;t=[];const i=e.length;for(n=0;n<i;n++)t.push(e[n])}else if("object"===i(e)){t={};for(let n in e)if(e.hasOwnProperty(n)){const r=e[n];if(r===e)continue;"array"===i(r)||"object"===i(r)?t[n]=o(r):t[n]=r}}else t=e;return t}n.d(t,{Dy:()=>r,Jh:()=>c,Oh:()=>s,d9:()=>o,ds:()=>l,p:()=>a,p6:()=>d});function r(e){let t=0,n="当前密码只包含",i={flag:!1,message:""};return/\s/.test(e)?(i.message="密码不支持空格",i):/[\u4e00-\u9fa5]+/.test(e)?(i.message="密码不支持中文",i):e.length<8||e.length>20?(i.message="密码长度需要在 8-20 位之间",i):(/([a-z])+/.test(e)&&(n+="小写字母 ",t++),/([A-Z])+/.test(e)&&(n+="大写字母 ",t++),/(\d)+/.test(e)&&(n+="数字 ",t++),/[!"#\$%&'\(\)\*\+,-\.\/:;<=>\?@\[\\\]\^_`\{\|\}~]/.test(e)&&(n+="特殊字符 ",t++),t<3?i.message=n:(i.flag=!0,i.message=""),i)}function c(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e.trim())}function a(e){return/1\d{10}/g.test(e.trim())}function l(e){return/^((25[0-5]|2[0-4]\d|[1]{1}\d{1}\d{1}|[1-9]{1}\d{1}|\d{1})($|(?!\.$)\.)){4}$/.test(e)}function s(e){let t=e.split(":"),n=0,i="";if(t.length>2)n=Number(t.pop()),i=t.join(":");else{if(2!==t.length)throw new Error("无法解析服务器地址");i=t[0],n=Number(t[1])}return{host:i,port:n}}function d(e,t="yyyy-MM-dd",n="--"){if(!e)return n;let i=new Date(e);if(e=e+60*i.getTimezoneOffset()*1e3- -288e5,i.setTime(e),"Invalid Date"===i.toString())return n;let o={"M+":i.getMonth()+1,"d+":i.getDate(),"h+":i.getHours(),"m+":i.getMinutes(),"s+":i.getSeconds(),"q+":Math.floor((i.getMonth()+3)/3),S:i.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(i.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in o)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?o[e]:("00"+o[e]).substr((""+o[e]).length)));return t}},35247:(e,t,n)=>{n.d(t,{Yi:()=>d,bC:()=>u,wz:()=>s,we:()=>l,Du:()=>a,bL:()=>y});var i=n(48402),o=n(6298),r=n(6522),c=n(88538);const a={1:"云电脑",2:"云电脑",3:"云手机"};var l;!function(e){e[e.UNDO=0]="UNDO",e[e.IGNORE=1]="IGNORE"}(l||(l={}));const s={1:"非工作时间异常",2:"登录地点异常","1#2":"非工作时间异常和登录地点异常"},d={10:"瘦终端",11:"瘦终端",15:"IPTV",20:"Android Phone",25:"PC",26:"WinXP-PC",30:"iPhone",35:"Android Pad",40:"iPad",45:"Mac",60:"Web客户端",90:"Web"},u={10:{color:"#32CC93",name:"equipment-1"},11:{color:"#32CC93",name:"equipment-1"},15:{color:"#4CA7FB",name:"equipment-3"},20:{color:"#4CA7FB",name:"equipment-3"},25:{color:"#FD893A",name:"equipment-4"},26:{color:"#FD893A",name:"equipment-4"},30:{color:"#4CA7FB",name:"equipment-2"},35:{color:"#4CA7FB",name:"equipment-3"},40:{color:"#4CA7FB",name:"equipment-2"},45:{color:"#FD893A",name:"equipment-5"},def:{color:"#FD893A",name:"equipment-6"}};var m,p,f,g=function(e,t,n,i){var o,r=arguments.length,c=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(c=(r<3?o(c):r>3?o(t,n,c):o(t,n))||c);return r>3&&c&&Object.defineProperty(t,n,c),c},v=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},h=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function c(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,a)}l((i=i.apply(e,t||[])).next())}))};let y=class{constructor(e,t,n){this.auth=e,this.request=t,this.env=n}getLogs(e){return h(this,void 0,void 0,(function*(){e.oneDay||1!==e.pageNum||(e.lastRecordLoginTime=0,e.lastRecordUserLogId=0);return(yield this.getApi("api/cdserv/client/getLogs",e)).data}))}getExcepLogCounts(e){return h(this,void 0,void 0,(function*(){const t=yield this.auth.getAuthProfile();if(!e||!t)return;const n={desktopId:e,userId:t.userId};return(yield this.getApi("api/cdserv/client/getExcepLogCounts",n)).data}))}ignoreAllExcepLogs(){return h(this,void 0,void 0,(function*(){return yield this.postApi("api/cdserv/client/ignoreAllExcepLogs")}))}handleExcepLog(e){return h(this,void 0,void 0,(function*(){return yield this.postApi("api/cdserv/client/handleExcepLog",e)}))}getDeviceList(){return h(this,void 0,void 0,(function*(){return(yield this.getApi("api/cdserv/client/device/list")).data}))}deviceUnbind(e){return h(this,void 0,void 0,(function*(){return yield this.postApi("api/cdserv/client/device/unbinding",e)}))}deviceEdit(e){return h(this,void 0,void 0,(function*(){return yield this.postApi("api/cdserv/client/device/edit",e)}))}getApi(e,t){return this.request.api({url:e,method:"GET",params:t})}postApi(e,t){return h(this,void 0,void 0,(function*(){return this.request.api({url:e,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:t})}))}};y=g([(0,i.Xn)(),v("design:paramtypes",["function"==typeof(m=void 0!==o.g&&o.g)?m:Object,"function"==typeof(p=void 0!==c.cf&&c.cf)?p:Object,"function"==typeof(f=void 0!==r.Xb&&r.Xb)?f:Object])],y)},9961:(e,t,n)=>{n.r(t),n.d(t,{default:()=>S});var i=n(89810),o=n(35247),r=n(6522),c=n(48402),a=n(73827),l=n(72900),s=n(88533),d=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function c(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,a)}l((i=i.apply(e,t||[])).next())}))};const u=e=>((0,i.pushScopeId)("data-v-14aaecc4"),e=e(),(0,i.popScopeId)(),e),m={class:"container"},p={key:0,class:"container-intro"},f={key:1,class:"container-main"},g=u((()=>(0,i.createElementVNode)("div",{class:"container-main-title"},"当前设备",-1))),v={class:"container-main-list-item-name"},h={class:"container-main-list-item-detail"},y={class:"container-main-list-item-sys"},E={class:"container-main-list-item-time"},C=u((()=>(0,i.createElementVNode)("div",{class:"container-main-title"},"已验证设备",-1))),N={class:"container-main-list"},b=["onClick"],V={class:"container-main-list-item-name"},k={class:"container-main-list-item-name-detail"},D={class:"container-main-list-item-sys"},w={class:"container-main-list-item-time"},x={key:2,class:"container-empty"},A=(0,i.defineComponent)({__name:"DeviceManage",emits:["enter"],setup(e,{emit:t}){const n=c.nC.get(r.Xb),u=c.nC.get(o.bL),A=(0,i.inject)("$dialog");var S=(0,i.ref)([]),B=(0,i.ref)(!1),T=(0,i.ref)(null);function L(e){s.$x.emit("toggle",{type:"DeviceDetail",data:e})}function q(){return d(this,void 0,void 0,(function*(){try{B.value=!0,S.value=yield u.getDeviceList(),S.value.forEach((e=>{var t,n;e.icon=(t=e.deviceType.toString(),(n=(0,l.d9)(o.bC[t]||o.bC.def)).name=`icon-${n.name}`,n)})),function(e){const t=n.getDeviceCode().toUpperCase();e.some((e=>{if(e.deviceCode.toUpperCase()===t)return T.value=e,T.value.isCurr=!0,!0}))}(S.value)}catch(e){a.z8.error("获取设备列表失败"),setTimeout((()=>{s.$x.emit("toggle",{type:"SecureCenter"})}),1500)}finally{B.value=!1}}))}return(0,i.onMounted)((()=>d(this,void 0,void 0,(function*(){yield q(),(0,i.nextTick)((()=>{var e=A.getCurrentDialogId();A.config(e,{title:"设备管理",extendSlot:[],onBack:()=>{s.$x.emit("toggle",{type:"SecureCenter"})}})}))})))),(e,t)=>{const n=(0,i.resolveComponent)("el-tooltip"),r=(0,i.resolveDirective)("loading");return(0,i.openBlock)(),(0,i.createElementBlock)("div",m,[(0,i.unref)(S).length?((0,i.openBlock)(),(0,i.createElementBlock)("p",p,"您可以从列表中删除设备，删除后将该设备踢下线并抹除已记住的密码。 此外，在该设备再次登录需要进行身份认证")):(0,i.createCommentVNode)("",!0),(0,i.unref)(S).length?(0,i.withDirectives)(((0,i.openBlock)(),(0,i.createElementBlock)("div",f,[g,(0,i.unref)(T)?((0,i.openBlock)(),(0,i.createElementBlock)("div",{key:0,onClick:t[0]||(t[0]=e=>L((0,i.unref)(T))),class:"container-main-list-item"},[(0,i.createElementVNode)("div",v,[(0,i.createElementVNode)("i",{style:(0,i.normalizeStyle)({background:(0,i.unref)(T).icon.color}),class:(0,i.normalizeClass)(["iconfont container-main-list-item-name-icon",(0,i.unref)(T).icon.name])},null,6),(0,i.createElementVNode)("div",h,[(0,i.createVNode)(n,{effect:"light",content:(0,i.unref)(T).deviceName,placement:"top-start","show-arrow":!1},{default:(0,i.withCtx)((()=>[(0,i.createElementVNode)("div",null,(0,i.toDisplayString)((0,i.unref)(T).deviceName),1)])),_:1},8,["content"]),(0,i.createElementVNode)("div",null,(0,i.toDisplayString)((0,i.unref)(o.Yi)[(0,i.unref)(T).deviceType]),1)])]),(0,i.createElementVNode)("span",y,[(0,i.createTextVNode)(" 设备系统： "),(0,i.createElementVNode)("span",null,(0,i.toDisplayString)((0,i.unref)(T).sysVersion||"--"),1)]),(0,i.createElementVNode)("span",E,[(0,i.createTextVNode)(" 最近登录： "),(0,i.createElementVNode)("span",null,(0,i.toDisplayString)((0,i.unref)(l.p6)((0,i.unref)(T).lastUseTime,"MM月dd日 hh:mm:ss")),1)])])):(0,i.createCommentVNode)("",!0),C,(0,i.createElementVNode)("ul",N,[((0,i.openBlock)(!0),(0,i.createElementBlock)(i.Fragment,null,(0,i.renderList)((0,i.unref)(S),(e=>((0,i.openBlock)(),(0,i.createElementBlock)("li",{key:e.bindingId,onClick:t=>L(e),class:"container-main-list-item"},[(0,i.createElementVNode)("div",V,[(0,i.createElementVNode)("i",{style:(0,i.normalizeStyle)({background:e.icon.color}),class:(0,i.normalizeClass)(["iconfont container-main-list-item-name-icon",e.icon.name])},null,6),(0,i.createElementVNode)("div",k,[(0,i.createVNode)(n,{effect:"light",content:e.deviceName,placement:"top-start","show-arrow":!1,offset:0},{default:(0,i.withCtx)((()=>[(0,i.createElementVNode)("div",null,(0,i.toDisplayString)(e.deviceName),1)])),_:2},1032,["content"]),(0,i.createElementVNode)("div",null,(0,i.toDisplayString)((0,i.unref)(o.Yi)[e.deviceType]),1)])]),(0,i.createElementVNode)("span",D,[(0,i.createTextVNode)(" 设备系统： "),(0,i.createElementVNode)("span",null,(0,i.toDisplayString)(e.sysVersion),1)]),(0,i.createElementVNode)("span",w,[(0,i.createTextVNode)(" 最近登录： "),(0,i.createElementVNode)("span",null,(0,i.toDisplayString)((0,i.unref)(l.p6)(e.lastUseTime,"MM月dd日 hh:mm:ss")),1)])],8,b)))),128))])])),[[r,(0,i.unref)(B)]]):(0,i.createCommentVNode)("",!0),0!=(0,i.unref)(S).length||(0,i.unref)(B)?(0,i.createCommentVNode)("",!0):((0,i.openBlock)(),(0,i.createElementBlock)("div",x,"暂无设备"))])}}});const S=(0,n(57775).Z)(A,[["__scopeId","data-v-14aaecc4"]])}}]);